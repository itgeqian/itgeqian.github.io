<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>GQ Video项目部署</title>
      <link href="/posts/2.html"/>
      <url>/posts/2.html</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th>服务名称</th><th>英文名</th><th>端口号</th><th>版本号</th><th>服务类别</th></tr></thead><tbody><tr><td>数据库</td><td>mysql</td><td>3306</td><td>v8.26</td><td>环境依赖</td></tr><tr><td>搜索引擎</td><td>es</td><td>9201</td><td>3.1.9</td><td>环境依赖</td></tr><tr><td>缓存</td><td>Redis</td><td>6379</td><td>v8</td><td>环境依赖</td></tr><tr><td>消息队列</td><td>RocketMQ</td><td></td><td>2.3.0</td><td>环境依赖</td></tr><tr><td>注册中心</td><td>nacos</td><td>8848</td><td>v2.2.0</td><td>环境依赖</td></tr><tr><td>网关服务</td><td>easylive-cloud-gateway</td><td>7071</td><td>java8</td><td>项目</td></tr><tr><td>分布式事务</td><td>Seata</td><td>7091</td><td>2021.0.5.0</td><td>环境依赖</td></tr><tr><td>对象存储</td><td>Minio</td><td>9000</td><td>2024-09-13T20-26-02Z</td><td>环境依赖</td></tr><tr><td>管理端服务</td><td>easylive-cloud-admin</td><td>7070</td><td>java8</td><td>项目</td></tr><tr><td>用户端服务</td><td>easylive-cloud-web</td><td>7072</td><td>java8</td><td>项目</td></tr><tr><td>交互服务</td><td>easylive-cloud-interact</td><td>7073</td><td>java8</td><td>项目</td></tr><tr><td>资源服务</td><td>easylive-cloud-resource</td><td>7074</td><td>java8</td><td>项目</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h1 id="微服务项目部署指导">微服务项目部署指导</h1><p><em>Exported on 2025/10/6 at GMT+8 0:12:27 from Cursor (1.4.2)</em></p><hr><p><strong>User</strong></p><p>整个项目已经完结，请你仔细查看一下项目的结构，我现在想要把这个微服务项目部署到一个我已经准备好的4核4g的服务器上该如何部署，是选择用宝塔面板还是用docker compose部署呢，请你指引着我一步步完成部署@c:\Users\wanglei\Desktop\<a href="http://xn--i0yq5pe7ol9g.md">项目部署.md</a></p><hr><p><strong>Cursor</strong></p><p>我先快速查看各微服务的配置文件端口与外部依赖（Nacos、Redis、RocketMQ、Minio 等）的指向，确保 docker-compose 方案能一次性把依赖与服务都编排好。随后我会给出一步步部署清单与可直接使用的 compose 文件与构建命令。</p><p>我将先创建一个部署任务清单，随后直接给出推荐方案（Docker Compose）与可运行的命令、配置与文件模板。接下来我会把全部步骤一次性写全，便于你按部就班执行。</p><p>我先并行打开各微服务的配置文件，确认注册中心、配置名与端口设置，以便给出可直接可用的 docker-compose 参数和环境变量。接着我会确定采用 Docker Compose 的总体策略并开始给出脚本。</p><p>我已确认各服务的 <code>bootstrap.yml</code> 通过 Nacos 加载共享配置且默认指向 127.0.0.1:8848，容器化时需用环境变量覆盖为 nacos:8848。现在我先确定采用 Docker Compose 方案，并开始给出安装与编排文件。接下来把“安装 Docker/Compose”设为进行中。</p><p>我将并行打开各服务的 dev 配置文件，确认数据库、存储和消息队列的连接信息，以便在 docker-compose 中正确注入环境变量。</p><p>我将把“安装 Docker/Compose”完成并开始“创建目录结构与 .env 机密变量”，随后给出<code>.env</code>和<code>docker-compose.yml</code>模板与执行命令。接着我会继续推进依赖与应用编排等步骤，并同步勾选对应待办。</p><p>我已经确定采用 Docker Compose 部署，并开始输出目录结构、<code>.env</code> 与依赖编排模板，随后给出后端镜像构建与应用编排、前端与 Nginx 配置。接着我会把“创建目录结构与 .env”标记完成，并开启“依赖服务编排”和“应用编排”。</p><p>我已确认采用 Docker Compose 并核对了各微服务的 Nacos 配置与端口。现在我会直接给出一步步部署清单、必要命令与可用模板（.env、docker-compose、Dockerfile、Nginx），你可以按顺序执行。随后我会把清单项勾选完成。### 结论与建议</p><ul><li>建议使用 Docker Compose 部署。原因：<ul><li>多个基础依赖（MySQL/Redis/Nacos/RocketMQ/Minio/ES/Seata）与 5 个 SpringBoot 微服务需要统一编排、网络与持久化，更易复现与维护。</li><li>日志、重启策略、资源限制、备份与迁移都更容易标准化。</li></ul></li><li>4 核 4G 机器资源偏紧。建议先上线核心链路（MySQL、Redis、Nacos、Minio、网关与核心三服务），RocketMQ/ES/Seata如非强依赖可延后启用，或按需独立机器。</li></ul><h3 id="端口规划（来自你的部署文档）">端口规划（来自你的部署文档）</h3><ul><li>数据库 MySQL: 3306</li><li>Nacos: 8848</li><li>网关 <code>easylive-cloud-gateway</code>: 7071</li><li>管理端 <code>easylive-cloud-admin</code>: 7070</li><li>用户端 <code>easylive-cloud-web</code>: 7072</li><li>交互 <code>easylive-cloud-interact</code>: 7073</li><li>资源 <code>easylive-cloud-resource</code>: 7074</li><li>Redis: 6379</li><li>Minio: 9000(服务) + 9001(控制台)</li><li>RocketMQ/ES/Seata：按需启用（建议后置）</li></ul><p>下面步骤直接可执行，按顺序来。</p><h3 id="1-安装-Docker-Compose（以-Ubuntu-20-04-22-04-为例）">1) 安装 Docker &amp; Compose（以 Ubuntu 20.04/22.04 为例）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1) 基础依赖</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get update -y</span><br><span class="line"><span class="built_in">sudo</span> apt-get install -y ca-certificates curl gnupg lsb-release</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) Docker 仓库</span></span><br><span class="line"><span class="built_in">sudo</span> install -m 0755 -d /etc/apt/keyrings</span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg \</span><br><span class="line"> | <span class="built_in">sudo</span> gpg --dearmor -o /etc/apt/keyrings/docker.gpg</span><br><span class="line"><span class="built_in">echo</span> \</span><br><span class="line">  <span class="string">&quot;deb [arch=<span class="subst">$(dpkg --print-architecture)</span> signed-by=/etc/apt/keyrings/docker.gpg] \</span></span><br><span class="line"><span class="string">  https://download.docker.com/linux/ubuntu <span class="subst">$(lsb_release -cs)</span> stable&quot;</span> \</span><br><span class="line"> | <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br><span class="line"><span class="built_in">sudo</span> apt-get update -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) 安装</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4) 免 sudo（重新登录生效）</span></span><br><span class="line"><span class="built_in">sudo</span> usermod -aG docker <span class="variable">$USER</span></span><br></pre></td></tr></table></figure><h3 id="2-目录结构与时区">2) 目录结构与时区</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /opt/easylive/&#123;mysql/data,mysql/init,redis,data,nacos,data,minio/data,nginx/conf.d,frontend/&#123;web,admin&#125;,logs&#125;</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /opt/easylive/&#123;gateway,admin,web,interact,resource&#125;/config</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /opt/easylive/&#123;rocketmq/&#123;namesrv,broker&#125;,es/data,seata&#125;</span><br><span class="line"><span class="built_in">sudo</span> timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure><h3 id="3-env（放到-opt-easylive-env）">3) .env（放到 /opt/easylive/.env）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">TZ=Asia/Shanghai</span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQL</span></span><br><span class="line">MYSQL_ROOT_PASSWORD=YourStrongRootPass!</span><br><span class="line">MYSQL_DATABASE=easylive</span><br><span class="line"></span><br><span class="line"><span class="comment"># Nacos</span></span><br><span class="line">NACOS_VERSION=v2.2.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Minio</span></span><br><span class="line">MINIO_ROOT_USER=admin</span><br><span class="line">MINIO_ROOT_PASSWORD=YourStrongMinioPass!</span><br><span class="line"></span><br><span class="line"><span class="comment"># Java 内存建议（4G 机器尽量克制）</span></span><br><span class="line">JAVA_XMS=256m</span><br><span class="line">JAVA_XMX=512m</span><br></pre></td></tr></table></figure><h3 id="4-docker-compose-yml（放到-opt-easylive-docker-compose-yml）">4) docker-compose.yml（放到 /opt/easylive/docker-compose.yml）</h3><p>为节省内存，RocketMQ/ES/Seata 先注释，核心链路先跑通。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.9&quot;</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">easylive</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">easylive-net:</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">mysql-data:</span></span><br><span class="line">  <span class="attr">redis-data:</span></span><br><span class="line">  <span class="attr">nacos-data:</span></span><br><span class="line">  <span class="attr">minio-data:</span></span><br><span class="line">  <span class="attr">es-data:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:8.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--default-authentication-plugin=mysql_native_password</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--character-set-server=utf8mb4</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=$&#123;MYSQL_DATABASE&#125;</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3306:3306&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql-data:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./mysql/init:/docker-entrypoint-initdb.d</span></span><br><span class="line">    <span class="attr">healthcheck:</span></span><br><span class="line">      <span class="attr">test:</span> [<span class="string">&quot;CMD-SHELL&quot;</span>,<span class="string">&quot;mysqladmin ping -uroot -p$&#123;MYSQL_ROOT_PASSWORD&#125; | grep &#x27;mysqld is alive&#x27;&quot;</span>]</span><br><span class="line">      <span class="attr">interval:</span> <span class="string">10s</span></span><br><span class="line">      <span class="attr">timeout:</span> <span class="string">5s</span></span><br><span class="line">      <span class="attr">retries:</span> <span class="number">30</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:6.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">command:</span> [ <span class="string">&quot;redis-server&quot;</span>, <span class="string">&quot;--appendonly&quot;</span>, <span class="string">&quot;yes&quot;</span> ]</span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis-data:/data</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nacos:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nacos/nacos-server:$&#123;NACOS_VERSION&#125;</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nacos</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MODE=standalone</span></span><br><span class="line">      <span class="comment"># 使用 MySQL 做持久化（推荐）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PLATFORM=mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_HOST=mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_DB_NAME=nacos_config</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_PORT=3306</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_USER=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="comment"># JVM 缩小</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">JVM_XMS=256m</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">JVM_XMX=512m</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">JVM_XMN=256m</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="attr">mysql:</span></span><br><span class="line">        <span class="attr">condition:</span> <span class="string">service_healthy</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8848:8848&quot;</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">minio:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">minio/minio:RELEASE.2024-09-13T20-26-02Z</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">minio</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MINIO_ROOT_USER=$&#123;MINIO_ROOT_USER&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MINIO_ROOT_PASSWORD=$&#123;MINIO_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">server</span> <span class="string">/data</span> <span class="string">--console-address</span> <span class="string">&quot;:9001&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">minio-data:/data</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9000:9000&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9001:9001&quot;</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 如无强依赖，先不启动下列服务，稳定后再启用</span></span><br><span class="line">  <span class="comment"># rocketmq-namesrv:</span></span><br><span class="line">  <span class="comment">#   image: apache/rocketmq:5.2.0</span></span><br><span class="line">  <span class="comment">#   container_name: rmq-namesrv</span></span><br><span class="line">  <span class="comment">#   ports: [&quot;9876:9876&quot;]</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - TZ=$&#123;TZ&#125;</span></span><br><span class="line">  <span class="comment">#     - JAVA_OPT_EXT=-Xms256m -Xmx512m</span></span><br><span class="line">  <span class="comment">#   networks: [easylive-net]</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># rocketmq-broker:</span></span><br><span class="line">  <span class="comment">#   image: apache/rocketmq:5.2.0</span></span><br><span class="line">  <span class="comment">#   container_name: rmq-broker</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - NAMESRV_ADDR=rmq-namesrv:9876</span></span><br><span class="line">  <span class="comment">#     - TZ=$&#123;TZ&#125;</span></span><br><span class="line">  <span class="comment">#     - JAVA_OPT_EXT=-Xms256m -Xmx512m</span></span><br><span class="line">  <span class="comment">#   depends_on: [rocketmq-namesrv]</span></span><br><span class="line">  <span class="comment">#   ports: [&quot;10911:10911&quot;,&quot;10909:10909&quot;,&quot;10912:10912&quot;]</span></span><br><span class="line">  <span class="comment">#   networks: [easylive-net]</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># es:</span></span><br><span class="line">  <span class="comment">#   image: docker.elastic.co/elasticsearch/elasticsearch:7.17.22</span></span><br><span class="line">  <span class="comment">#   container_name: es</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - discovery.type=single-node</span></span><br><span class="line">  <span class="comment">#     - xpack.security.enabled=false</span></span><br><span class="line">  <span class="comment">#     - ES_JAVA_OPTS=-Xms512m -Xmx512m</span></span><br><span class="line">  <span class="comment">#     - TZ=$&#123;TZ&#125;</span></span><br><span class="line">  <span class="comment">#   ulimits:</span></span><br><span class="line">  <span class="comment">#     memlock:</span></span><br><span class="line">  <span class="comment">#       soft: -1</span></span><br><span class="line">  <span class="comment">#       hard: -1</span></span><br><span class="line">  <span class="comment">#   ports:</span></span><br><span class="line">  <span class="comment">#     - &quot;9201:9200&quot;</span></span><br><span class="line">  <span class="comment">#   volumes:</span></span><br><span class="line">  <span class="comment">#     - es-data:/usr/share/elasticsearch/data</span></span><br><span class="line">  <span class="comment">#   networks: [easylive-net]</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># seata:</span></span><br><span class="line">  <span class="comment">#   image: seataio/seata-server:1.6.1</span></span><br><span class="line">  <span class="comment">#   container_name: seata</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - SEATA_PORT=7091</span></span><br><span class="line">  <span class="comment">#     - TZ=$&#123;TZ&#125;</span></span><br><span class="line">  <span class="comment">#   ports: [&quot;7091:7091&quot;]</span></span><br><span class="line">  <span class="comment">#   networks: [easylive-net]</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ------------------ 应用服务 ------------------</span></span><br><span class="line">  <span class="attr">gateway:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-gateway:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">gateway</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7071</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">nacos</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7071:7071&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">admin:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-admin:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">admin</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7070</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="comment"># 覆盖数据库与 Redis（如 Nacos 未配置完整）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_USERNAME=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_HOST=redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PORT=6379</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">mysql</span>, <span class="string">redis</span>, <span class="string">nacos</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7070:7070&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-web:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">web</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7072</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_USERNAME=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_HOST=redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PORT=6379</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">mysql</span>, <span class="string">redis</span>, <span class="string">nacos</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7072:7072&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">interact:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-interact:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">interact</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7073</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_USERNAME=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_HOST=redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PORT=6379</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">mysql</span>, <span class="string">redis</span>, <span class="string">nacos</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7073:7073&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">resource:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-resource:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">resource</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7074</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_USERNAME=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_HOST=redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PORT=6379</span></span><br><span class="line">      <span class="comment"># 如资源服务用到 Minio，请在 Nacos 配置或此处补充访问参数</span></span><br><span class="line">      <span class="comment"># - MINIO_ENDPOINT=http://minio:9000</span></span><br><span class="line">      <span class="comment"># - MINIO_ACCESS_KEY=$&#123;MINIO_ROOT_USER&#125;</span></span><br><span class="line">      <span class="comment"># - MINIO_SECRET_KEY=$&#123;MINIO_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="comment"># - MINIO_BUCKET=your-bucket</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">mysql</span>, <span class="string">redis</span>, <span class="string">nacos</span>, <span class="string">minio</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7074:7074&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.25</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">gateway</span>]</span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./nginx/conf.d:/etc/nginx/conf.d</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./frontend/web:/usr/share/nginx/html</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./frontend/admin:/usr/share/nginx/html/admin</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br></pre></td></tr></table></figure><h3 id="5-后端服务镜像构建">5) 后端服务镜像构建</h3><p>建议每个服务放一个最简 Dockerfile（以 <code>easylive-cloud-gateway</code> 为例）：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 放在 easylive-server/easylive-cloud/easylive-cloud-gateway/Dockerfile</span></span><br><span class="line"><span class="keyword">FROM</span> eclipse-temurin:<span class="number">8</span>-jre</span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> target/*.jar app.jar</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">7071</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>,<span class="string">&quot;-Xms<span class="variable">$&#123;JAVA_XMS:-256m&#125;</span>&quot;</span>,<span class="string">&quot;-Xmx<span class="variable">$&#123;JAVA_XMX:-512m&#125;</span>&quot;</span>,<span class="string">&quot;-jar&quot;</span>,<span class="string">&quot;/app/app.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>构建步骤（在你的仓库根目录执行；其他四个服务同理更换路径与镜像名/端口）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打包全部（跳过测试）</span></span><br><span class="line"><span class="built_in">cd</span> /path/to/easylive-springcloud/easylive-server</span><br><span class="line">./mvnw -v || mvn -v</span><br><span class="line">mvn -DskipTests clean package</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建镜像（五个服务）</span></span><br><span class="line">docker build -t easylive-cloud-gateway:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-gateway</span><br><span class="line"></span><br><span class="line">docker build -t easylive-cloud-admin:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-admin</span><br><span class="line"></span><br><span class="line">docker build -t easylive-cloud-web:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-web</span><br><span class="line"></span><br><span class="line">docker build -t easylive-cloud-interact:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-interact</span><br><span class="line"></span><br><span class="line">docker build -t easylive-cloud-resource:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-resource</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>端口通过 <code>SERVER_PORT</code> 覆盖为 7071/7070/7072/7073/7074，跟你的表一致。</li><li>Nacos 地址在容器间为 <code>nacos:8848</code>（已在 compose 中用环境变量覆盖）。</li><li>数据库/Redis 在容器间为 <code>mysql:3306</code>、<code>redis:6379</code>。</li></ul><h3 id="6-Nginx-反代与前端">6) Nginx 反代与前端</h3><p><code>/opt/easylive/nginx/conf.d/easylive.conf</code>：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">  <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">  <span class="attribute">server_name</span> _;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 用户端 Web 静态</span></span><br><span class="line">  <span class="attribute">root</span> /usr/share/nginx/html;</span><br><span class="line">  <span class="attribute">index</span> index.html;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 管理端静态（访问 /admin/）</span></span><br><span class="line">  <span class="section">location</span> /admin/ &#123;</span><br><span class="line">    <span class="attribute">alias</span> /usr/share/nginx/html/admin/;</span><br><span class="line">    <span class="attribute">try_files</span> <span class="variable">$uri</span> <span class="variable">$uri</span>/ /admin/index.html;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 反向代理到网关（和 gateway 的路由保持一致）</span></span><br><span class="line">  <span class="section">location</span> /web/       &#123; <span class="attribute">proxy_pass</span> http://gateway:7071/web/; &#125;</span><br><span class="line">  <span class="section">location</span> /interact/  &#123; <span class="attribute">proxy_pass</span> http://gateway:7071/interact/; &#125;</span><br><span class="line">  <span class="section">location</span> /user/      &#123; <span class="attribute">proxy_pass</span> http://gateway:7071/user/; &#125;</span><br><span class="line">  <span class="section">location</span> /file/      &#123; <span class="attribute">proxy_pass</span> http://gateway:7071/file/; &#125;</span><br><span class="line">  <span class="section">location</span> /adminapi/  &#123; <span class="attribute">proxy_pass</span> http://gateway:7071/admin/; &#125; <span class="comment"># 避免静态路径冲突，给管理端 API 换前缀</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">proxy_set_header</span> Host              <span class="variable">$host</span>;</span><br><span class="line">  <span class="attribute">proxy_set_header</span> X-Real-IP         <span class="variable">$remote_addr</span>;</span><br><span class="line">  <span class="attribute">proxy_set_header</span> X-Forwarded-For   <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">  <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>构建前端并拷贝静态资源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用户端</span></span><br><span class="line"><span class="built_in">cd</span> /path/to/easylive-springcloud/easylive-front/easylive-front-web</span><br><span class="line">npm ci || npm install</span><br><span class="line">npm run build</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">cp</span> -r dist/* /opt/easylive/frontend/web/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 管理端</span></span><br><span class="line"><span class="built_in">cd</span> /path/to/easylive-springcloud/easylive-front/easylive-front-admin</span><br><span class="line">npm ci || npm install</span><br><span class="line">npm run build</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /opt/easylive/frontend/admin</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">cp</span> -r dist/* /opt/easylive/frontend/admin/</span><br></pre></td></tr></table></figure><p>如前端请求网关的基地址可配置，建议改为相对路径并按上面 Nginx 反代规则访问。</p><h3 id="7-Minio-初始化（可选）">7) Minio 初始化（可选）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> --network easylive_easylive-net -it \</span><br><span class="line">  minio/mc sh -c <span class="string">&quot;</span></span><br><span class="line"><span class="string">mc alias set minio http://minio:9000 <span class="variable">$&#123;MINIO_ROOT_USER&#125;</span> <span class="variable">$&#123;MINIO_ROOT_PASSWORD&#125;</span> &amp;&amp; \</span></span><br><span class="line"><span class="string">mc mb -p minio/easylive &amp;&amp; \</span></span><br><span class="line"><span class="string">mc anonymous set download minio/easylive&quot;</span></span><br></pre></td></tr></table></figure><h3 id="8-Nacos-配置">8) Nacos 配置</h3><ul><li>访问 <code>http://服务器IP:8848/nacos</code>，默认无鉴权或按镜像默认设置。</li><li>为每个服务新增配置：<ul><li><code>easylive-cloud-admin-dev.yml</code></li><li><code>easylive-cloud-web-dev.yml</code></li><li><code>easylive-cloud-interact-dev.yml</code></li><li><code>easylive-cloud-resource-dev.yml</code></li><li>内容至少包含数据库与 Redis 连接（参考你仓库中 dev yml，将 host 从 127.0.0.1 改为 <code>mysql</code>、<code>redis</code>）：</li></ul></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br></pre></td></tr></table></figure><ul><li>资源服务若使用 Minio，请在对应 yml 增加 Minio 配置项（按你项目属性命名），指向 <code>http://minio:9000</code>。</li></ul><h3 id="9-启动与验证">9) 启动与验证</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/easylive</span><br><span class="line">docker compose pull   <span class="comment"># 第一次可忽略</span></span><br><span class="line">docker compose up -d  <span class="comment"># 启动</span></span><br><span class="line">docker compose ps     <span class="comment"># 查看状态</span></span><br><span class="line">docker logs -f gateway</span><br><span class="line">docker logs -f admin</span><br><span class="line">docker logs -f web</span><br><span class="line">docker logs -f interact</span><br><span class="line">docker logs -f resource</span><br></pre></td></tr></table></figure><ul><li>浏览器访问：<ul><li>Nacos: <code>http://服务器IP:8848/nacos</code></li><li>Minio: <code>http://服务器IP:9001</code></li><li>前端: <code>http://服务器IP/</code>（用户端）与 <code>http://服务器IP/admin/</code>（管理端）</li></ul></li><li>后端连通性：网关 <code>http://服务器IP:7071</code> 下的 <code>/web/**</code>、<code>/interact/**</code>、<code>/user/**</code>、<code>/file/**</code>、<code>/admin/**</code>。</li></ul><h3 id="10-域名与-HTTPS（可选快速）">10) 域名与 HTTPS（可选快速）</h3><ul><li>用 Nginx + Certbot：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install -y certbot python3-certbot-nginx</span><br><span class="line"><span class="built_in">sudo</span> certbot --nginx -d your.domain.com -m your@email \</span><br><span class="line">  --agree-tos --no-eff-email --redirect</span><br></pre></td></tr></table></figure><ul><li>或用 Caddy（更简单，自动签发）：将 Nginx 换成 <code>caddy:2</code>，用 Caddyfile 一行反代网关和静态。</li></ul><h3 id="11-常见资源与优化建议">11) 常见资源与优化建议</h3><ul><li>4G 机器内存紧张：先不上 RocketMQ/ES/Seata，JVM 堆保持 <code>-Xms256m -Xmx512m</code>；Nacos JVM 也已收敛。</li><li>MySQL/ES/Minio 数据请使用卷持久化（compose 已配置）。</li><li>日志落盘到容器 stdout，建议再配 ELK/Vector 后续接入。</li></ul><p>你现在可以按以上顺序执行；如果遇到端口/内存/配置问题，发我报错我继续帮你排查。</p><ul><li>我已经完成部署方案选择与全部步骤指引，包含 <code>.env</code>、<code>docker-compose.yml</code>、后端 Dockerfile、Nginx 反代与初始化要点。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 1) 基础依赖</span><br><span class="line">sudo apt-get update -y</span><br><span class="line">sudo apt-get install -y ca-certificates curl gnupg lsb-release</span><br><span class="line"></span><br><span class="line"># 2) Docker 仓库</span><br><span class="line">sudo install -m 0755 -d /etc/apt/keyrings</span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg \</span><br><span class="line"> | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg</span><br><span class="line">echo \</span><br><span class="line">  &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \</span><br><span class="line">  https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot; \</span><br><span class="line"> | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br><span class="line">sudo apt-get update -y</span><br><span class="line"></span><br><span class="line"># 3) 安装</span><br><span class="line">sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br><span class="line"></span><br><span class="line"># 4) 免 sudo（重新登录生效）</span><br><span class="line">sudo usermod -aG docker $USER</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /opt/easylive/&#123;mysql/data,mysql/init,redis,data,nacos,data,minio/data,nginx/conf.d,frontend/&#123;web,admin&#125;,logs&#125;</span><br><span class="line">sudo mkdir -p /opt/easylive/&#123;gateway,admin,web,interact,resource&#125;/config</span><br><span class="line">sudo mkdir -p /opt/easylive/&#123;rocketmq/&#123;namesrv,broker&#125;,es/data,seata&#125;</span><br><span class="line">sudo timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">TZ=Asia/Shanghai</span><br><span class="line"></span><br><span class="line"># MySQL</span><br><span class="line">MYSQL_ROOT_PASSWORD=YourStrongRootPass!</span><br><span class="line">MYSQL_DATABASE=easylive</span><br><span class="line"></span><br><span class="line"># Nacos</span><br><span class="line">NACOS_VERSION=v2.2.0</span><br><span class="line"></span><br><span class="line"># Minio</span><br><span class="line">MINIO_ROOT_USER=admin</span><br><span class="line">MINIO_ROOT_PASSWORD=YourStrongMinioPass!</span><br><span class="line"></span><br><span class="line"># Java 内存建议（4G 机器尽量克制）</span><br><span class="line">JAVA_XMS=256m</span><br><span class="line">JAVA_XMX=512m</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.9&quot;</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">easylive</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">easylive-net:</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">mysql-data:</span></span><br><span class="line">  <span class="attr">redis-data:</span></span><br><span class="line">  <span class="attr">nacos-data:</span></span><br><span class="line">  <span class="attr">minio-data:</span></span><br><span class="line">  <span class="attr">es-data:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:8.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--default-authentication-plugin=mysql_native_password</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--character-set-server=utf8mb4</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=$&#123;MYSQL_DATABASE&#125;</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3306:3306&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql-data:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./mysql/init:/docker-entrypoint-initdb.d</span></span><br><span class="line">    <span class="attr">healthcheck:</span></span><br><span class="line">      <span class="attr">test:</span> [<span class="string">&quot;CMD-SHELL&quot;</span>,<span class="string">&quot;mysqladmin ping -uroot -p$&#123;MYSQL_ROOT_PASSWORD&#125; | grep &#x27;mysqld is alive&#x27;&quot;</span>]</span><br><span class="line">      <span class="attr">interval:</span> <span class="string">10s</span></span><br><span class="line">      <span class="attr">timeout:</span> <span class="string">5s</span></span><br><span class="line">      <span class="attr">retries:</span> <span class="number">30</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:6.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">command:</span> [ <span class="string">&quot;redis-server&quot;</span>, <span class="string">&quot;--appendonly&quot;</span>, <span class="string">&quot;yes&quot;</span> ]</span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis-data:/data</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nacos:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nacos/nacos-server:$&#123;NACOS_VERSION&#125;</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nacos</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MODE=standalone</span></span><br><span class="line">      <span class="comment"># 使用 MySQL 做持久化（推荐）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PLATFORM=mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_HOST=mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_DB_NAME=nacos_config</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_PORT=3306</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_USER=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_SERVICE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="comment"># JVM 缩小</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">JVM_XMS=256m</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">JVM_XMX=512m</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">JVM_XMN=256m</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="attr">mysql:</span></span><br><span class="line">        <span class="attr">condition:</span> <span class="string">service_healthy</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8848:8848&quot;</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">minio:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">minio/minio:RELEASE.2024-09-13T20-26-02Z</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">minio</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MINIO_ROOT_USER=$&#123;MINIO_ROOT_USER&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MINIO_ROOT_PASSWORD=$&#123;MINIO_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">server</span> <span class="string">/data</span> <span class="string">--console-address</span> <span class="string">&quot;:9001&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">minio-data:/data</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9000:9000&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9001:9001&quot;</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># 如无强依赖，先不启动下列服务，稳定后再启用</span></span><br><span class="line">  <span class="comment"># rocketmq-namesrv:</span></span><br><span class="line">  <span class="comment">#   image: apache/rocketmq:5.2.0</span></span><br><span class="line">  <span class="comment">#   container_name: rmq-namesrv</span></span><br><span class="line">  <span class="comment">#   ports: [&quot;9876:9876&quot;]</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - TZ=$&#123;TZ&#125;</span></span><br><span class="line">  <span class="comment">#     - JAVA_OPT_EXT=-Xms256m -Xmx512m</span></span><br><span class="line">  <span class="comment">#   networks: [easylive-net]</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># rocketmq-broker:</span></span><br><span class="line">  <span class="comment">#   image: apache/rocketmq:5.2.0</span></span><br><span class="line">  <span class="comment">#   container_name: rmq-broker</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - NAMESRV_ADDR=rmq-namesrv:9876</span></span><br><span class="line">  <span class="comment">#     - TZ=$&#123;TZ&#125;</span></span><br><span class="line">  <span class="comment">#     - JAVA_OPT_EXT=-Xms256m -Xmx512m</span></span><br><span class="line">  <span class="comment">#   depends_on: [rocketmq-namesrv]</span></span><br><span class="line">  <span class="comment">#   ports: [&quot;10911:10911&quot;,&quot;10909:10909&quot;,&quot;10912:10912&quot;]</span></span><br><span class="line">  <span class="comment">#   networks: [easylive-net]</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># es:</span></span><br><span class="line">  <span class="comment">#   image: docker.elastic.co/elasticsearch/elasticsearch:7.17.22</span></span><br><span class="line">  <span class="comment">#   container_name: es</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - discovery.type=single-node</span></span><br><span class="line">  <span class="comment">#     - xpack.security.enabled=false</span></span><br><span class="line">  <span class="comment">#     - ES_JAVA_OPTS=-Xms512m -Xmx512m</span></span><br><span class="line">  <span class="comment">#     - TZ=$&#123;TZ&#125;</span></span><br><span class="line">  <span class="comment">#   ulimits:</span></span><br><span class="line">  <span class="comment">#     memlock:</span></span><br><span class="line">  <span class="comment">#       soft: -1</span></span><br><span class="line">  <span class="comment">#       hard: -1</span></span><br><span class="line">  <span class="comment">#   ports:</span></span><br><span class="line">  <span class="comment">#     - &quot;9201:9200&quot;</span></span><br><span class="line">  <span class="comment">#   volumes:</span></span><br><span class="line">  <span class="comment">#     - es-data:/usr/share/elasticsearch/data</span></span><br><span class="line">  <span class="comment">#   networks: [easylive-net]</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># seata:</span></span><br><span class="line">  <span class="comment">#   image: seataio/seata-server:1.6.1</span></span><br><span class="line">  <span class="comment">#   container_name: seata</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - SEATA_PORT=7091</span></span><br><span class="line">  <span class="comment">#     - TZ=$&#123;TZ&#125;</span></span><br><span class="line">  <span class="comment">#   ports: [&quot;7091:7091&quot;]</span></span><br><span class="line">  <span class="comment">#   networks: [easylive-net]</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># ------------------ 应用服务 ------------------</span></span><br><span class="line">  <span class="attr">gateway:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-gateway:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">gateway</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7071</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">nacos</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7071:7071&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">admin:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-admin:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">admin</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7070</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="comment"># 覆盖数据库与 Redis（如 Nacos 未配置完整）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_USERNAME=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_HOST=redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PORT=6379</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">mysql</span>, <span class="string">redis</span>, <span class="string">nacos</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7070:7070&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-web:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">web</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7072</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_USERNAME=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_HOST=redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PORT=6379</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">mysql</span>, <span class="string">redis</span>, <span class="string">nacos</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7072:7072&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">interact:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-interact:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">interact</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7073</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_USERNAME=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_HOST=redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PORT=6379</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">mysql</span>, <span class="string">redis</span>, <span class="string">nacos</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7073:7073&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">resource:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">easylive-cloud-resource:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">resource</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=$&#123;TZ&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SERVER_PORT=7074</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=dev</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=nacos:8848</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_USERNAME=root</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PASSWORD=$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_HOST=redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PORT=6379</span></span><br><span class="line">      <span class="comment"># 如资源服务用到 Minio，请在 Nacos 配置或此处补充访问参数</span></span><br><span class="line">      <span class="comment"># - MINIO_ENDPOINT=http://minio:9000</span></span><br><span class="line">      <span class="comment"># - MINIO_ACCESS_KEY=$&#123;MINIO_ROOT_USER&#125;</span></span><br><span class="line">      <span class="comment"># - MINIO_SECRET_KEY=$&#123;MINIO_ROOT_PASSWORD&#125;</span></span><br><span class="line">      <span class="comment"># - MINIO_BUCKET=your-bucket</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">mysql</span>, <span class="string">redis</span>, <span class="string">nacos</span>, <span class="string">minio</span>]</span><br><span class="line">    <span class="attr">ports:</span> [<span class="string">&quot;7074:7074&quot;</span>]</span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.25</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">depends_on:</span> [<span class="string">gateway</span>]</span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./nginx/conf.d:/etc/nginx/conf.d</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./frontend/web:/usr/share/nginx/html</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./frontend/admin:/usr/share/nginx/html/admin</span></span><br><span class="line">    <span class="attr">networks:</span> [<span class="string">easylive-net</span>]</span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br></pre></td></tr></table></figure><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 放在 easylive-server/easylive-cloud/easylive-cloud-gateway/Dockerfile</span></span><br><span class="line"><span class="keyword">FROM</span> eclipse-temurin:<span class="number">8</span>-jre</span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> target/*.jar app.jar</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">7071</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>,<span class="string">&quot;-Xms<span class="variable">$&#123;JAVA_XMS:-256m&#125;</span>&quot;</span>,<span class="string">&quot;-Xmx<span class="variable">$&#123;JAVA_XMX:-512m&#125;</span>&quot;</span>,<span class="string">&quot;-jar&quot;</span>,<span class="string">&quot;/app/app.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 打包全部（跳过测试）</span><br><span class="line">cd /path/to/easylive-springcloud/easylive-server</span><br><span class="line">./mvnw -v || mvn -v</span><br><span class="line">mvn -DskipTests clean package</span><br><span class="line"></span><br><span class="line"># 构建镜像（五个服务）</span><br><span class="line">docker build -t easylive-cloud-gateway:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-gateway</span><br><span class="line"></span><br><span class="line">docker build -t easylive-cloud-admin:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-admin</span><br><span class="line"></span><br><span class="line">docker build -t easylive-cloud-web:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-web</span><br><span class="line"></span><br><span class="line">docker build -t easylive-cloud-interact:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-interact</span><br><span class="line"></span><br><span class="line">docker build -t easylive-cloud-resource:latest \</span><br><span class="line">  easylive-cloud/easylive-cloud-resource</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name _;</span><br><span class="line"></span><br><span class="line">  # 用户端 Web 静态</span><br><span class="line">  root /usr/share/nginx/html;</span><br><span class="line">  index index.html;</span><br><span class="line"></span><br><span class="line">  # 管理端静态（访问 /admin/）</span><br><span class="line">  location /admin/ &#123;</span><br><span class="line">    alias /usr/share/nginx/html/admin/;</span><br><span class="line">    try_files $uri $uri/ /admin/index.html;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  # 反向代理到网关（和 gateway 的路由保持一致）</span><br><span class="line">  location /web/       &#123; proxy_pass http://gateway:7071/web/; &#125;</span><br><span class="line">  location /interact/  &#123; proxy_pass http://gateway:7071/interact/; &#125;</span><br><span class="line">  location /user/      &#123; proxy_pass http://gateway:7071/user/; &#125;</span><br><span class="line">  location /file/      &#123; proxy_pass http://gateway:7071/file/; &#125;</span><br><span class="line">  location /adminapi/  &#123; proxy_pass http://gateway:7071/admin/; &#125; # 避免静态路径冲突，给管理端 API 换前缀</span><br><span class="line"></span><br><span class="line">  proxy_set_header Host              $host;</span><br><span class="line">  proxy_set_header X-Real-IP         $remote_addr;</span><br><span class="line">  proxy_set_header X-Forwarded-For   $proxy_add_x_forwarded_for;</span><br><span class="line">  proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 用户端</span><br><span class="line">cd /path/to/easylive-springcloud/easylive-front/easylive-front-web</span><br><span class="line">npm ci || npm install</span><br><span class="line">npm run build</span><br><span class="line">sudo cp -r dist/* /opt/easylive/frontend/web/</span><br><span class="line"></span><br><span class="line"># 管理端</span><br><span class="line">cd /path/to/easylive-springcloud/easylive-front/easylive-front-admin</span><br><span class="line">npm ci || npm install</span><br><span class="line">npm run build</span><br><span class="line">sudo mkdir -p /opt/easylive/frontend/admin</span><br><span class="line">sudo cp -r dist/* /opt/easylive/frontend/admin/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm --network easylive_easylive-net -it \</span><br><span class="line">  minio/mc sh -c &quot;</span><br><span class="line">mc alias set minio http://minio:9000 $&#123;MINIO_ROOT_USER&#125; $&#123;MINIO_ROOT_PASSWORD&#125; &amp;&amp; \</span><br><span class="line">mc mb -p minio/easylive &amp;&amp; \</span><br><span class="line">mc anonymous set download minio/easylive&quot;</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://mysql:3306/easylive?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">$&#123;MYSQL_ROOT_PASSWORD&#125;</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/easylive</span><br><span class="line">docker compose pull   # 第一次可忽略</span><br><span class="line">docker compose up -d  # 启动</span><br><span class="line">docker compose ps     # 查看状态</span><br><span class="line">docker logs -f gateway</span><br><span class="line">docker logs -f admin</span><br><span class="line">docker logs -f web</span><br><span class="line">docker logs -f interact</span><br><span class="line">docker logs -f resource</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y certbot python3-certbot-nginx</span><br><span class="line">sudo certbot --nginx -d your.domain.com -m your@email \</span><br><span class="line">  --agree-tos --no-eff-email --redirect</span><br></pre></td></tr></table></figure><hr><p><strong>User</strong></p><p>4核8g的服务器是否够用能把所有的环境都配上呢，保险起见我是不是应该换个4核8g的服务器</p><hr><p><strong>Cursor</strong></p><p>结论先说：</p><ul><li>4核8G基本能把全套（MySQL/Redis/Nacos/Minio/ES/RocketMQ/Seata + 5个Java服务 + 网关）跑起来，但比较“紧”，需要严格限内存与低负载场景，属于可用但不太宽裕。</li><li>若计划“全部组件长期开启 + 有一定并发”，建议至少换到4核8G；若要更稳，优先把 ES 或 RocketMQ 单独拆机，或直接上更高规格（如8核16G）。</li></ul><p>快速内存预算（保守建议，单位≈GiB）：</p><ul><li>Nacos: 0.5</li><li>MySQL: 0.5–1.0（取决于 innodb_buffer_pool_size）</li><li>Redis: 0.1–0.3</li><li>Minio: 0.3–0.5</li><li>RocketMQ: 0.8–1.2（namesrv 0.3–0.5，broker 0.5–0.7）</li><li>Elasticsearch: 1.0–2.0（堆1–2G，且需 vm.max_map_count）</li><li>Seata: 0.3–0.5</li><li>5个SpringBoot服务: 1.3–2.5（每个 256–512M）</li><li>合计：约 5.3–8.5G（随设置和负载浮动）<br>=&gt; 4核8G在“全部开启”时边缘可用，需非常克制的JVM与DB配置。</li></ul><p>给你两种选择：</p><ul><li>想省事稳一点：换成4核8G（或更高），然后严格控内存即可全开；更理想是把 ES 或 RocketMQ 独立出去。</li><li>先不换服务器：保留4核4G/8G，只启核心链路（MySQL/Redis/Nacos/Minio/网关+业务服务），把 ES/RocketMQ/Seata 暂时关闭或托管到云上，等业务量起来再扩。</li></ul><p>若坚持在4核8G全开运行，务必：</p><ul><li>JVM：所有Java进程统一 -Xms256m -Xmx512m（Nacos、各微服务、Seata、RocketMQ），ES 堆设 1G 起步。</li><li>MySQL：innodb_buffer_pool_size 512M 起；慢慢再调大。</li><li>开启2–4G swap 兜底（仅兜底，不可依赖）。</li><li>用 docker-compose 限制每个容器内存并监控 docker stats。</li><li>优先上线无强依赖的路径；ES/RocketMQ 负载上来后优先拆分或升配。</li></ul><p>简短建议：</p><ul><li>如果你希望“一台机全家桶 + 可留有余量”，我建议换到4核8G（更稳）或把 ES/RocketMQ 外置/托管。</li><li>如果是演示/低QPS场景，4核8G可行；4核4G就建议按我给的最小化编排先跑核心链路。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 项目相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目部署 </tag>
            
            <tag> GQ Video </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端web复习</title>
      <link href="/posts/4.html"/>
      <url>/posts/4.html</url>
      
        <content type="html"><![CDATA[<p>备考蓝桥杯时写的复习文档（目前有html+css+JavaScript+Ajax）<br>共263页</p><p><a href="https://www.legendkiller.xyz/wp-content/uploads/2025/05/web%E5%A4%8D%E4%B9%A0.pdf">https://www.legendkiller.xyz/wp-content/uploads/2025/05/web复习.pdf</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>六级生词</title>
      <link href="/posts/3.html"/>
      <url>/posts/3.html</url>
      
        <content type="html"><![CDATA[<p>radiate 散发</p><p>herd 兽群</p><p>immerse 沉浸于</p><p>consent 同意</p><p>manipulate 暗中操作</p><p>relentless 不停的，持续的</p><p>fluctuate 波动</p><p>exotic 异国风情的，外来的</p><p>census 官方统计</p><p>simultaneous 同步的，同时存在</p><p>hinge 铰链</p><p>inevitable 不可避免的</p><p>impair 削弱</p><p>saturate 浸透，使饱和</p><p>crawl 爬行</p><p>retail 零售</p><p>insurance 保险</p><p>device 想出</p><p>dynamic 动态的，充满活力的</p><p>fiscal 财政的</p><p>patrol 巡逻</p><p>scrape 刮掉</p><p>pasture 牧场</p><p>metropolitan 大城市的</p><p>explicit 清楚的</p><p>institution 机构，习俗</p><p>crack 破裂</p><p>incorporate 包含，并入</p><p>conserve 节约</p><p>lever 操纵杆</p><p>utter 完全的</p><p>preliminary 初步的</p><p>harsh 严厉的</p><p>illuminate 照亮</p><p>ascend 上升</p><p>decay 腐烂</p><p>bizarre 奇异的，古怪的</p><p>sensitive 体贴的</p><p>diagnose 诊断</p><p>authentic 真品的</p><p>substantial 大量的</p><p>destined 命中注定的</p><p>contrive 设法做到</p><p>feeble虚弱无力的</p><p>cater 满足，迎合</p><p>catastrophe 重大灾难</p><p>correlate 相互关联</p><p>torture 拷打</p><p>perish 死亡</p><p>fragile 易碎的</p><p>peculiar 古怪的，奇怪的</p><p>cruise 乘船游览</p><p>parliament 议会</p><p>perpetual 长久的</p><p>reckless 鲁莽的</p><p>calorie 卡路里</p><p>intrigue 激起…兴趣</p><p>assemble 集合</p><p>estimate 估计</p><p>impulse 冲动</p><p>eligible 有资格的</p><p>deliver发表</p><p>avert防止</p><p>glitter 闪亮</p><p>consensus 一致看法</p><p>versus 与…相比</p><p>fabricate 捏造</p><p>tumble 跌倒</p><p>lure 引诱</p><p>spectrum 光谱，系列</p><p>aviation 航空</p><p>extinct 已灭绝的</p><p>tremendous 巨大的</p><p>priest 牧师</p><p>unveil 公布</p><p>renowned 有名的</p><p>signify 表示</p><p>designate 指定</p><p>insulate 使隔热，使隔音</p><p>inferior 较差的</p><p>proclaim 宣布，声明</p><p>vigorous 精力旺盛的</p><p>candidate 候选人</p><p>greed 贪婪</p><p>imperial 帝国的</p><p>inhibit 抑制</p><p>revolve 旋转</p><p>temperament 气质</p><p>corporate 公司的</p><p>substitute 代替者</p><p>compliment 称赞</p><p>contradict 反驳</p><p>fragile 易碎的</p><p>scare 缺乏的</p><p>ultimate 最终的</p><p>escalate 扩大</p><p>adolescent 青少年</p><p>mediate 调停</p><p>stroke 一击</p><p>collaboration 合作</p><p>monetary 货币的</p><p>clinic 诊所</p><p>suicide 自杀</p><p>interpret 解释，说明</p><p>conspicuous 易见的</p><p>evacuate 撤离</p><p>evoke 引起</p><p>profitable 盈利的</p><p>counsel 忠告，建议</p><p>aggressive 好斗的</p><p>pitch 球场</p><p>fatigue 疲惫的</p><p>legitimate 合法的</p><p>tropical 热带的</p><p>perceive 看待</p><p>prototype 原型</p><p>derail 脱轨</p><p>deficit 亏损</p><p>contract 合同</p><p>institute n.机构 v. 建立</p><p>catastrophe 重大灾难</p><p>recreation 娱乐</p><p>veteran 有经验的人，老手</p><p>eject 驱逐</p><p>plight 困境</p><p>ascribe 将…归因于</p><p>poll 民意调查</p><p>indigenous 当地的</p><p>advisable 明智的</p><p>chronic 慢性的</p><p>external 外部的</p><p>momentum 势头</p><p>gloomy 昏暗的</p><p>ingenious 精巧的</p><p>stagger 蹒跚</p><p>arrogant 傲慢的</p><p>exclude 将……排斥在外</p><p>retrieve 取回</p><p>workship 崇拜</p><p>biography 人物传记</p><p>ambiguous 模棱两可的</p><p>dispatch 派遣</p><p>concede 承认……属实</p><p>neutral 中立的</p><p>strive 努力</p><p>speculate 猜测</p><p>inventory 存货</p><p>coordinate 使……协调</p><p>dazzle 使目眩</p><p>transient 短暂的</p><p>ferry 渡船</p><p>lawsuit 诉讼</p><p>depict 描绘</p><p>fascinate 使着迷</p><p>moan 呻吟</p><p>dimension 尺寸</p><p>sway 摇摆</p><p>academic 学术的</p><p>applause 鼓掌</p><p>dictate 口述，命令</p><p>quote 引用</p><p>circulation 血液循环</p><p>ration 定量供应</p><p>odd 奇怪的</p><p>indicate 声明，暗示</p><p>eliminate 消除</p><p>municipal 城市的</p><p>migrate 迁移</p><p>rigor 严谨</p><p>merit 优秀品质</p><p>warrant 授权令，使合理</p><p>scenario 设想</p><p>exempt 被免除</p><p>coalition 联合体，联盟</p><p>expire 到期</p><p>coincide 同时发生</p><p>propel 推动</p><p>execute 执行</p><p>rage 暴怒</p><p>refine 提炼</p><p>rash 轻率的</p><p>cater 提供饮食，迎合</p><p>induce 引诱</p><p>permeate 渗透</p><p>spontaneous 自发的</p><p>robust 强健的</p><p>blend 融合</p><p>colonial 殖民地的</p><p>pedestrian 行人</p><p>antibiotic 抗生素的</p><p>simulate 假装</p><p>flee 逃离</p><p>hurricane 飓风</p><p>recipient 接受者</p><p>controversy 争论</p><p>confer 授予</p><p>refer 涉及</p><p>infer 推断</p><p>shuttle 航天飞机</p><p>intrinsic 本质的</p><p>sentiment 情绪</p><p>inquire询问</p><p>require需要</p><p>acquire获得</p><p>enquire询问</p><p>diligent 勤奋的</p><p>segregate 隔离</p><p>shatter 破碎</p><p>epidemic 流行病</p><p>enterprise 企业</p><p>viable 可行的</p><p>precise 精确的</p><p>manifest 显示，表明</p><p>esteem 尊重</p><p>premium 保险费</p><p>spectacle 眼睛，奇特的现象</p><p>prejudice 偏见</p><p>setback 挫折</p><p>buck 美元，抵制</p><p>drastic 严厉的</p><p>offspring 子女，后代</p><p>acquaint 使熟悉</p><p>demography 人口学的</p><p>nonetheless 尽管如此</p><p>scrutiny 彻底审查</p><p>disclose 透露</p><p>magnitude 巨大</p><p>retort 反驳</p><p>session 一场</p><p>therapy 疗法</p><p>predecessor 前任</p><p>formula 公式</p><p>ward 病房</p><p>expel 开除</p><p>gadget 小器具</p><p>pension 养老金</p><p>prosper 兴旺</p><p>fraud 诈骗</p><p>supervisor 监督者</p><p>toll 伤亡人数</p><p>descend 下来，下降</p><p>enormous 巨大的</p><p>furnish 布置</p><p>incentive 激励</p><p>refute 反驳</p><p>negotiate谈判</p><p>aggravate 加重</p><p>terminate 结束，终止</p><p>enlighten 启发</p><p>inertia 惯性</p><p>skeptical 怀疑的</p><p>chunk 厚块</p><p>brew 啤酒，酝酿</p><p>duplicate 复制</p><p>assess 评估</p><p>sake目的</p><p>narrative 叙事</p><p>purchase 购买</p><p>magnify放大</p><p>severe 严重的</p><p>installment 一期</p><p>assert 断言</p><p>boom 繁荣</p><p>hectic 忙碌的</p><p>dismay 使担心，使失望</p><p>democratic 民主的</p><p>justify 证明</p><p>conflict 冲突</p><p>dilemma 窘境，困境</p><p>peculiar 古怪的</p><p>tenant 房客</p><p>ascertain 弄清</p><p>heir继承人</p><p>chamber 房间，议院</p><p>detain 拘留</p><p>greedy 贪婪的</p><p>resort 求助</p><p>migrant 移民者</p><p>weird 古怪的</p><p>crucial 至关重要的</p><p>moreover 而且</p><p>agony 极度痛苦的</p><p>demonstrate 表明，证明</p><p>graphic 绘画的</p><p>vaccine 疫苗</p><p>cruise 乘船浏览</p><p>rational 合理的</p><p>domestic 国内的</p><p>accurate 准确的</p><p>ethnic 种族的</p><p>conducive 有助于的</p><p>remedy 解决方法</p><p>collide 碰撞</p><p>cripple 瘸子</p><p>livestock 牲畜</p><p>disgust 厌恶</p><p>envisage 设想</p><p>inherent 内在的</p><p>solemn 严肃的</p><p>concise 简洁的</p><p>condemn 谴责</p><p>augment增大</p><p>obedient 服从的</p><p>lane 小路</p><p>maneuver 策略</p><p>portray描述</p><p>surgeon 外科医生</p><p>forge 建立</p><p>reconcile 使和谐一致</p><p>liberal 自由的</p><p>accommodation 住宿</p><p>implement 履行</p><p>internal 国内的</p><p>navigate导航</p><p>mortgage 抵押</p><p>accessory 配件</p><p>executive 经理</p><p>exile 流行</p><p>dividend 红利</p><p>regulation 规章</p><p>correlate 相互关联</p><p>instruct 指示</p><p>kit 成套工具</p><p>arrogance 傲慢</p><p>unprecedented 史无前例的</p><p>swell 肿胀</p><p>amend 修订</p><p>extract 提取</p><p>intimate 亲密的</p><p>devastate 彻底破坏</p><p>withdraw 撤回</p><p>graze 吃青草</p><p>grope 摸索，寻找</p><p>distracted 注意力分散的</p><p>obscure 难以理解的，掩盖</p><p>subordinate 下级，下属</p><p>contaminate 弄脏，污染</p><p>retreat 撤退</p><p>cherish 珍爱</p><p>conscience 良心</p><p>erupt 火山爆发</p><p>subtle 细微的</p><p>unleash 释放</p><p>endorse 公开支持</p><p>flaw 瑕疵</p><p>publicity 关注</p><p>endurance 耐力</p><p>fabric 织物</p><p>discriminate 歧视</p><p>peer 同龄人</p><p>subsidy 补贴</p><p>prime 首要的</p><p>compatible 兼容的</p><p>facet 部分</p><p>bleak 没有希望的</p><p>scatter 散开，播撒</p><p>revive 苏醒</p><p>irritate 使烦躁</p><p>maturity 成熟</p><p>plausible 貌似合理的</p><p>trivial 琐碎的</p><p>circuit 电路</p><p>galaxy 星系</p><p>deplete 大量消耗</p><p>preception 理解</p><p>loyalty 忠诚</p><p>violate 违反</p><p>adhere 黏附</p><p>paradox 矛盾的人，悖论</p><p>presume 推测</p><p>quit 辞去</p><p>irrational 不合理的</p><p>notion 观念</p><p>guard 卫兵，看守</p><p>baffle 使…困惑</p><p>dub 将…戏称为</p><p>institution 机构</p><p>superior 更好的，上级</p><p>contest 比赛</p><p>amplify 放大</p><p>deduce 推断</p><p>dignity 尊严，自尊</p><p>monopoly 垄断</p><p>cognitive 认识的</p><p>episode 一段经历</p><p>exclusive 独占的</p><p>jerk 猛拽</p><p>commute 上下班往返</p><p>conceive 想象</p><p>undermine 逐渐削弱</p><p>comply 服从</p><p>sophisticated 精密的，见多识广的，老练的</p><p>malicious 恶毒的</p><p>guardian 监护人</p><p>multitude 众多</p><p>nurture 培养</p><p>proposition 提议</p><p>diesel 柴油</p><p>articulate 清楚地表达</p><p>precedent 先例</p><p>infinite 无限的</p><p>consolidate 加强</p><p>boost 使增长</p><p>relay 传递</p><p>downside 缺点</p><p>distinct 截然不同的</p><p>allege 断言</p><p>allocate 分配</p><p>ponder 沉思</p><p>sanctuary 禁猎区</p><p>vicinity 周围地区</p><p>initial 开始的，最初的</p><p>contempt 鄙视</p><p>overwhelm 击败</p><p>territory 领土</p><p>trillion 一万亿</p><p>outdated 过时的</p><p>real estate 房地产</p><p>specify 具体指明</p><p>delicate 微妙的</p><p>blunt 钝的</p><p>deprive 剥夺</p><p>declaration 宣布</p><p>barrel 桶</p><p>equation 等式</p><p>oppress 压迫</p><p>flourish 繁荣</p><p>handicap 生理缺陷</p><p>extravagant 奢侈的</p><p>erase 消除</p><p>brisk 轻快的</p><p>negligible 微不足道的</p><p>addict 瘾君子</p><p>continent 洲，大陆</p><p>patent 专利权</p><p>recession 经济衰退</p><p>rival 竞争者</p><p>detach 摆脱</p><p>integral 必不可少的</p><p>endow 捐款</p><p>immune 免疫的</p><p>wipe out 彻底消灭</p><p>implicit 含蓄的</p><p>render 使变得</p><p>prevail 盛行</p><p>slump 暴跌</p><p>disrupt 使中断</p><p>deteriorate 恶化</p><p>stake 股份</p><p>consecutive 连续的</p><p>turbulent 动荡的</p><p>anticipate 预料</p><p>via经过</p><p>startle 使…吓一跳</p><p>quota 限额</p><p>literal 字面上的</p><p>penalty 罚金</p><p>eccentric 古怪的</p><p>prospective 潜在的</p><p>plunge 暴跌</p><p>neglect 疏忽</p><p>stimulus 刺激物</p><p>intricate 错综复杂的</p><p>occasional 偶尔的</p><p>hierarchy 等级制度</p><p>scholarly 学术的</p><p>protein 蛋白质</p><p>evaporate 蒸发</p><p>outset 开始</p><p>tuition 教授</p><p>intimidate 恐吓</p><p>pharmacy 病房</p><p>optic 眼的，视力的</p><p>memorial 纪念碑</p><p>intuition 直觉</p><p>prestige 威信</p><p>trait 特征</p><p>mourn 哀悼</p><p>enroll 使加入，招收</p><p>bureau 局，司，处，办事处</p><p>milestone 里程碑</p><p>tangle 缠结在一起</p><p>cast 扔</p><p>involved 卷入的</p><p>obsess 使痴迷</p><p>stun 使震惊</p><p>toss 扔</p><p>justification 正当理由</p><p>integrity 正直</p><p>dedicate 献身</p><p>parliament 议会</p><p>beam 光束</p><p>assure 确保</p><p>navigation 导航</p><p>endeavor 努力</p><p>scope 范围</p><p>multiple 多个的</p><p>prominent 杰出的</p><p>luxury 奢侈</p><p>impractical 不切实际的</p><p>insight 洞悉，洞察力</p><p>deposit 存款</p><p>emulate 效仿</p><p>subsidiary 辅助的，次要的</p><p>drown 溺死</p><p>rein 控制</p><p>jeopardize 使处于危险境地，危及</p><p>proof 证据</p><p>formulate 规划</p><p>thermal 热的，热量的</p><p>curriculum 课程</p><p>prevalent 流行的</p><p>antique 古董</p><p>contemplate 打算，考虑</p><p>capture 抓住</p><p>elevate 提拔</p><p>debris 残骸</p><p>paradise 天堂</p><p>slack 懈怠的，松弛的</p><p>hazard 危险</p><p>senator 参议员</p><p>exert 施加</p><p>haunt 萦绕，长期困扰</p><p>mutual 相互的</p><p>ornament 装饰品</p><p>confront 直面，正视</p><p>slight 轻微的</p><p>incur 招致</p><p>sculpture 雕像</p><p>bare 赤裸的，荒芜的</p><p>irrigate 灌溉</p><p>vacant 空的</p><p>reproach 责备</p><p>twist 弯曲变形</p><p>routine 惯例，常规</p><p>reassure 使安心</p><p>descendant 后代，后裔</p><p>barren 贫瘠的，荒芜的</p><p>rescue 营救</p><p>grim 严肃的，令人沮丧的</p><p>negotiation 谈判</p><p>guilt 内疚</p><p>industrial 工业的</p><p>hijack 劫持，控制</p><p>overstate 夸大</p><p>porch 门廊</p><p>analogy 类比</p><p>vulnerable 脆弱的</p><p>assumption 假设</p><p>contradiction 矛盾</p><p>intend 计划打算</p><p>humane 人道的</p><p>fossil 化石</p><p>statue 雕像</p><p>alter 警觉的</p><p>transplant 移植</p><p>temptation 引诱</p><p>solitude 独处</p><p>eager 热切的</p><p>alternate 交替的</p><p>resign 辞职</p><p>curb 控制</p><p>revenge 报复</p><p>assault 攻击</p><p>liable 可能做…的</p><p>hatch 孵化</p><p>cable 电缆</p><p>pest 害虫</p><p>surge 激增</p><p>nominal 象征性的，名义上的</p><p>settlement 协议，和解</p><p>frontier 边界</p><p>concrete 确实的，具体的</p><p>summon 召唤</p><p>embark 从事，着手</p><p>occupation 职业</p><p>abrupt 突然的，意外的</p><p>reluctant 勉强的</p><p>crush 捣碎，压碎</p><p>dominant 占支配地位的</p><p>compensate 弥补，补偿</p><p>instrument 仪器，乐器</p><p>stance 态度，立场</p><p>commerce 商业，贸易</p><p>corrupt 腐败的，不道德的</p><p>redundant 多余的</p><p>jungle 热带丛林</p><p>stabilize 稳定</p><p>embed 使…嵌入</p><p>literature 文学作品</p><p>commence 开始，着手</p><p>surpass 超过</p><p>destiny 命运</p><p>comprehensive 全面的，综合性的</p><p>resume 继续，简历</p><p>synthetic 合成的，人造的</p><p>sufficient 充足的</p><p>soar 升空，猛增</p><p>bias 偏见</p><p>degrade 有辱…的人格</p><p>conference 会议</p><p>underestimate 低估</p><p>disorder 失调，紊乱</p><p>tough 艰难的</p><p>interact 互动</p><p>preserve 维护</p><p>devastating 毁灭性的</p><p>hemisphere 半球</p><p>appliance 装置，家电</p><p>autonomy 自治权</p><p>dwell 居住</p><p>stimulate 刺激，激发</p><p>intent 意图，目的</p><p>pessimistic 悲观的</p><p>superiority 优越</p><p>jury 陪审团</p><p>given 指定的</p><p>notorious 臭名昭著的</p><p>considerable 相当多的</p><p>compact 紧凑的</p><p>carton 硬纸盒</p><p>freight 货物</p><p>choke 窒息</p><p>fuss 紧张不安</p><p>entertain 使快乐，娱乐</p><p>prolong 延长</p><p>criterion 标准</p><p>tactic 策略</p><p>hypothesis 假说</p><p>consult 向…咨询，求救</p><p>imperative 紧急的</p><p>bonus 奖金</p><p>incidentally 顺便提一下，偶然地</p><p>regardless 不管，无论如何</p><p>surgery 外科手术</p><p>massive 巨大的</p><p>consistent 一贯的</p><p>collision 碰撞</p><p>resemble 看起来像</p><p>breakthrough 突破</p><p>federal 联邦制的</p><p>illustrate 说明</p><p>distinctive 独特的，有特色的</p><p>responsive 反应敏捷的</p><p>excess 过多</p><p>casualty 伤亡人员</p><p>testify 作证</p><p>specialise 专门从事</p><p>delegate 代表</p><p>solidarity 团结一致</p><p>drill 钻机，演习</p><p>transaction 交易，业务</p><p>immigrant 移民</p><p>generalize 概括，归纳</p><p>sober 冷静的</p><p>impetus 动力，促进</p><p>benign 和善的，良性的</p><p>reserve 预订，预约</p><p>triumph 成功，胜利</p><p>likelihood 可能性</p><p>contact 联系</p><p>malignant 恶意的，恶性的</p><p>liability 责任</p><p>renew 延长</p><p>authority 权威，权力</p><p>browse 浏览，吃草</p><p>mentor 导师</p><p>innocent 无罪的</p><p>repel 驱逐，赶走</p><p>distress 悲伤，忧虑</p><p>obese 病态肥胖的，臃肿的</p><p>vegetation 植被</p><p>discharge 排出，解雇</p><p>interaction 互动</p><p>ideal 理想的</p><p>suppress 镇压，压抑</p><p>illiterate 文盲</p><p>paralyze 使瘫痪</p><p>plentiful 丰富的</p><p>destined 命中注定的</p><p>discrepancy 差异</p><p>conception 构思，概念</p><p>recognition 认出，识别</p><p>affiliate 使隶属于，使紧密联系</p><p>conscientious 认真的，勤勤恳恳</p><p>manual 人力的，体力的</p><p>minister 部长，大臣</p><p>oppose 反对</p><p>distort 使变形，使扭曲</p><p>deploy 部署</p><p>intelligible 可理解的</p><p>intermittent 间歇的，断断续续的</p><p>formidable 令人敬畏的</p><p>indifferent 不感兴趣的</p><p>denial 否认</p><p>phase 阶段</p><p>substantial 大量的</p><p>pause 暂停</p><p>drought 干旱</p><p>sustainable 可持续的</p><p>intangible 无形的，难以描述地</p><p>expedition 远征，探险</p><p>indulge 沉迷，满足</p><p>quest 探索，寻求</p><p>disastrous 灾难性的</p><p>sensation 知觉，感觉能力</p><p>observe 观察</p><p>resent 怨恨，憎恶</p><p>disguise 装扮，假扮</p><p>feasible 可行的</p><p>provoke 激起</p><p>accumulate 积累</p><p>assurance 担保，保证</p><p>tackle 处理</p><p>feeble 虚弱无力的</p><p>pursuit 追求</p><p>accuse 职责</p><p>compile 汇编</p><p>cabinet 储藏柜</p><p>objection 反对</p><p>engage 从事，参加</p><p>vast 巨大的</p><p>preside 主持</p><p>suspicion 怀疑</p><p>particle 微粒，粒子</p><p>subsistence 勉强生存</p><p>racial 种族间的，种族的</p><p>persistence 毅力</p><p>blaze 闪耀</p><p>convene 召集，召开</p><p>console 安慰，控制台</p><p>transition 过渡，转变</p><p>competence 能力，才干</p><p>hostile 敌意的，反对的</p><p>erect 建造</p><p>haze 烟雾</p><p>authorize 批准，授权</p><p>alternative 可代替的</p><p>consultant 顾问</p><p>perference 偏好</p><p>pole 杆子，地级</p><p>prescribe 开药，规定</p><p>populate 居住于</p><p>drawback 缺点，不利条件</p><p>morality 道德</p><p>ritual 仪式</p><p>genetic 遗传的，基因的</p><p>ingredient 配料，成分，因素</p><p>layer 层</p><p>transcend 超出，超越</p><p>plate 盘</p><p>angle 角度</p><p>spotlight 聚光灯</p><p>eternal 永恒的</p><p>successive 连续的</p><p>separate 单独的</p><p>promising 大有希望的</p><p>sequence 一系列</p><p>priority 优先权</p><p>compel 强迫，逼迫</p><p>implication 暗示，可能的影响</p><p>prosperity 兴旺</p><p>sneak 偷偷地走，潜行</p><p>concession 让步，认输</p><p>hamper 妨碍，阻碍</p><p>initiate 开始，发起</p><p>essence 本质</p><p>contrive 设法做到，图谋</p><p>instinct 本能</p><p>identical 完全相同的</p><p>protest 抗议，反对</p><p>conformity 遵从，遵守</p><p>deliberate 故意的</p><p>luminous 发亮的，发光的</p><p>plead 恳求</p><p>outbreak 爆发</p><p>fraction 少量，一点儿</p><p>derive 起源于，来自</p><p>elastic 有弹性的</p><p>mislead 误导</p><p>engagement 订婚，参加</p><p>reliance 依赖，依靠</p><p>polar 极地的</p><p>prescription 处方</p><p>cumulative 累加的</p><p>commodity 商品</p><p>revelation 揭露</p><p>strike 罢工，打，击</p><p>reservation 预订</p><p>encounter 遭遇</p><p>dispose 丢掉</p><p>bypass 旁道</p><p>combat 战斗，搏斗</p><p>stick 棍，刺入插入</p><p>stride 大步走，步伐</p><p>glamour 魅力，吸引力</p><p>reap 获得</p><p>layman 外行，门外汉</p><p>polish 改善，润色</p><p>patch 小块，斑点</p><p>perish 死亡</p><p>plea 恳求</p><p>virgin 未开发的，原始状态的</p><p>exceptional 杰出的，非凡的</p><p>rural 乡下的，乡村的</p><p>breed 繁殖，饲养</p><p>threshold 门槛，起始点</p><p>additive 添加剂，添加物</p><p>turnover 营业额</p><p>presumably 很可能</p><p>overturn 推翻</p><p>cease 停止</p><p>elite 精英</p><p>intensive 密集的</p><p>harmonious 和睦的</p><p>circumstance 情况，情形</p><p>persist 顽强坚持，持续</p><p>tease 逗弄</p><p>elicit 引出</p><p>celebrity 名人，明星</p><p>recur 再次发生</p><p>barely 仅仅</p><p>extent 程度</p><p>disregard 不理会</p><p>integrate 合并</p><p>torture 拷打，拷问</p><p>nourish 给…提供营养</p><p>inhabitant 居民</p><p>suspend 暂停，中止</p><p>snap 啪嗒声，断裂</p><p>provocative 挑衅的，煽动的</p><p>autonomous 自治的</p><p>federation 联盟，联合会</p><p>pesticide 杀虫剂</p><p>potency 影响力</p><p>interactive 交互的</p><p>potent 有强效的，烈性的</p><p>deviate 背离，偏离</p><p>specification 规格</p><p>convention 习俗，大会</p><p>specific 明确具体的</p><p>terrify 使害怕，使恐惧</p><p>contention 看法，争论</p><p>vice 恶习，副的次的</p><p>submerge 使浸没，淹没</p><p>opponent 对手，竞争者</p><p>obesity 肥胖</p><p>defy 违抗</p><p>terrific 极好的</p><p>tragedy 不幸，悲剧</p><p>acquaintance 熟人，了解</p><p>detect 发现</p><p>glacier 冰川</p><p>probe 追问</p><p>frantic 发狂似的</p><p>practitioner 从业人员</p><p>fund 基金</p><p>cooperative 合作的</p><p>invoke 唤起，引用</p><p>compulsory 强制性的，义务的</p><p>craftsmanship 手艺</p><p>disposal 丢掉</p><p>intensity 强烈，剧烈</p><p>striking 显著的</p><p>elaborate 复杂的，详尽的</p><p>elementary 基本的</p><p>subsidize 给…发补贴，补助</p><p>disperse 扩散，散开</p><p>underlie 构成…的基础</p><p>storage 储藏</p><p>peak 顶峰</p><p>mechanical 机械的</p><p>likewise 同样地</p><p>testimony 证词</p><p>utilize 利用，使用</p><p>breakdown 故障</p><p>restraint 制止，克制</p><p>quantitative 数量的</p><p>excessive 过多的</p><p>recruit 招收，招聘</p><p>lens 镜片</p><p>strategic 战略性的</p><p>qualitative 质量的</p><p>invariably 总是，不变地</p><p>surgical 外科手术的</p><p>miniature 很小的，微型的</p><p>premises 前提</p><p>headline 重要新闻</p><p>nominate 提名</p><p>urgency 紧急</p><p>marginal 微不足道的</p><p>voyage 航行，航海</p><p>vicious 恶性的，残暴的</p><p>journalist 记者</p><p>misguide 错误地引导</p><p>monitor 监视</p><p>initiative 主动性</p><p>shrink 缩水</p><p>precaution 预防措施</p><p>currency 货币，通货</p><p>questionnaire 调查问卷</p><p>bureaucracy 官僚制度，官僚主义</p><p>crisp 脆的</p><p>expertise 专门技术</p><p>compassion 同情，怜悯</p><p>conventional 传统的</p><p>invisible 看不见的</p><p>compromise 折中，妥协，让步</p><p>heighten 加强，增加</p><p>composer 作曲家</p><p>comprise 包括</p><p>thereby 因此</p><p>exaggerate 夸大</p><p>psychological 心理的</p><p>coverage 新闻报道</p><p>orthodox 正统的</p><p>decent 像样的，得体的</p><p>doom 厄运，使…注定遭受</p><p>specialty 专业</p><p>crude 粗略的</p><p>masterpiece 杰作</p><p>ordeal 折磨，苦难的经历</p><p>intensify 加强</p><p>disposition 性情，布置</p><p>burden 负担</p><p>mechanism 机械装置，方法</p><p>syndrome 综合征</p><p>transmission 传输</p><p>underlying 深层的</p><p>extensive 广阔的</p><p>suspicious 觉得可疑的</p><p>plenty 大量</p><p>inclined 倾向于…的</p><h1 id="六级作文模版">六级作文模版</h1><h2 id="议论文">议论文</h2><p>开头 Living in an era of rapid technological development ,and continuous expansion of knowledge,(主题)have/has become increasingly important,which is significantly impacting ( 某人的生活/学校生活/个人经历 ) <strong>生活在技术快速发展、知识不断扩展的时代，sth已经变得越来越重要，这对影响了某人的生活/学校生活/个人经历</strong></p><ul><li><p>当主题是…的影响时： Therefore, it’s of great significance for sb to do sth ，The following reasons can account for this viewpoint. <strong>因此，某人做某事具有重要意义，以下原因可以解释这一观点。</strong></p></li><li><p>当主题是…的重要性时：Therefore,I deem that the (importance of AI …的重要性/要贴近主题) lies in the following aspects <strong>因此，我认为sth的重要性在于以下几个方面</strong></p></li></ul><p>论据+论点</p><ul><li><p>论点1：First and foremost,there is no doubt that （sth can enhance sb work/study efficiency,and offer tremendous convenience in our daily/school life） <strong>首先，毫无疑问（某物可以提高某人的工作/学习效率，为我们的日常/学校生活提供极大的便利）</strong></p></li><li><p>论据1：Based on the investigation of big data(Based on big data research), it can be found that，a majority of (Accomplished individuals) admitted that they’ve spent most of their time doing sth <strong>通过大数据调查可以发现，大多数（成功人士）承认，他们大部分时间都花在做某事上</strong></p></li><li><p>论点2：Moreover,it has formed a consensus that（it has become a general consensus） (by sth can acquire adequate knowledge and experience easily,it is an excellent way for sb to understand what they hope and need) <strong>而且，这已经形成了一个共识，即（通过某事可以轻松获得足够的知识和经验，这是让某人了解他们希望和需要什么的绝佳方式）</strong></p></li><li><p>论点3：Last but not least,I sincerely believe that(by sth can facilitate communication and collaboration,which helpful <strong>in broadening</strong> ours horizons) <strong>最后但同样重要的一点是，我真诚地相信（通过某事可以促进沟通和合作，有助于拓宽我们的视野）</strong></p></li></ul><p>结尾</p><p>In short, the above statement can lead us reach a conclusion <strong>简而言之，通过上述陈述我们可以得出结论</strong></p><p>sth is revolutionizing the way we live,it is predictable that if sb makes reasonable use of sth,the future of sth will be become more beautiful and hopeful <strong>某事物正在彻底改变我们每个人的生活方式，可以预见，如果某人合理地利用某事物，其未来将会变得更加美好和充满希望</strong></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 英语六级 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实验三 汽车租赁系统的UML设计建模 （完结）</title>
      <link href="/posts/1.html"/>
      <url>/posts/1.html</url>
      
        <content type="html"><![CDATA[<p>一、实验目的及要求<br>对汽车租赁系统进行分析，利用 UML 工具进行建模。<br>二、实验环境<br>微型计算机、Rational Rose<br>三、实验内容</p><ol><li>对汽车租赁系统进行需求分析，并确定其基本模块，如基本数据维护模块、基本业务<br>模块、数据库模块、信息查询模块。</li><li>确定系统中的类，并生成类图和各个类之间的关系。</li><li>确定 UML 模型框架，并作出以下各图：<br>（1）系统的用例图<br>（2）系统的时序图<br>（3）系统的协作图<br>（4）系统的活动图<br>四、实验步骤<br>1．分析系统，写出系统的功能需求分析描述。<br>（1）基本数据维护模块应包括：<br>添加车辆信息；修改车辆信息；添加员工信息；修改员工信息等。<br>（2）基本业务模块应包括：<br>用户填写预定申请；工作人员处理预定请求；技术人员填写服务纪录；工作人员处理还<br>车请求；<br>（3）数据库模块应包括：<br>客户信息管理；车辆信息管理；租赁信息管理；员工信息管理；<br>（4）信息查询模块应包括：<br>查询客户信息；查询员工信息；查询车辆信息；查询客户租车记录等；</li><li>建立 UML 模型<br>包括用例图、类图、时序图、活动图、协作图、状态图的构建。</li></ol><h2 id="具体分析："><strong>具体分析：</strong></h2><h2 id="1-需求分析部分：">1.需求分析部分：</h2><h3 id="1-系统的功能需求分析"><strong>1.系统的功能需求分析</strong></h3><p>（1）基本数据维护模块应包括：</p><p>添加车辆信息；修改车辆信息；添加员工信息；修改员工信息等。</p><p>（2）基本业务模块应包括：用户填写预定申请；工作人员处理预定请求；技术人员填写服务纪录；工作人员处理还车请求；<br>（3）数据库模块应包括：客户信息管理；车辆信息管理；租赁信息管理；员工信息管理；</p><p>（4）信息查询模块应包括：查询客户信息；查询员工信息；查询车辆信息；查询客户租车记录等；</p><h3 id="2-基本数据维护模块"><strong>2</strong>.基本数据维护模块</h3><p>基本数据维护模块是汽车租赁系统中的基础功能模块，主要用于管理与系统运行相关的基础数据，包括车辆信息与员工信息的添加、修改等操作。该模块的良好设计有助于保持数据一致性和系统稳定性，为后续业务操作提供数据支持。</p><p>（1）添加汽车信息：汽车租聘处的车辆信息全部保存在数据库中，确保后续租赁、维护、查询等操作能准确定位目标车辆。<br>应包括以下字段：</p><ul><li>车辆编号（唯一标识）</li><li>品牌型号（如：丰田凯美瑞）</li><li>车牌号码</li><li>颜色</li><li>类型（轿车/越野车/商务车等）</li><li>日租金</li><li>当前状态（空闲/租赁中/维护中）</li></ul><p>功能需求：</p><ul><li>信息提交后，应自动存入车辆信息表中。</li><li>系统管理员登录后可通过图形界面填写车辆信息。</li><li>系统应对车辆编号、车牌号进行唯一性校验。</li></ul><p>（2）修改车辆信息：由于车辆信息可能发生变更（如状态变更、日租金调整等），系统应支持对已有车辆信息的修改。</p><p>功能需求：</p><ul><li>系统提供按车牌号或车辆编号的查询功能。</li><li>支持对车辆状态、日租金等字段的修改。</li></ul><p>（3）添加员工信息：为支持系统操作、客户服务等功能，所有员工的信息需录入系统。</p><p>应包括以下字段：</p><ul><li>员工编号（唯一标识）</li><li>姓名</li><li>岗位（如：管理员、技术人员、客服人员）</li><li>联系电话</li><li>入职日期</li></ul><p>功能需求：</p><ul><li>信息验证后保存至员工信息表中。</li><li>由管理员添加员工信息。</li><li>员工编号自动生成或手动录入，确保唯一性。</li></ul><p>（4）修改员工信息</p><p>为应对员工岗位调整、联系方式变更等情况，系统应支持员工信息的维护与更新。</p><p>功能需求：</p><ul><li>修改记录应自动存档以备追踪。</li><li>支持通过员工编号查询目标员工。</li><li>可修改姓名、联系方式、岗位等内容。</li></ul><h3 id="3-基本业务模块"><strong>3.基本业务模块</strong></h3><p>基本业务模块是汽车租赁系统中最核心的功能板块，涉及用户与系统之间的交互行为，覆盖租赁全过程的操作，包括预定、车辆服务、还车等环节。</p><p>（1）用户填写预定申请：</p><p>用户在系统中发起租车请求，填写所需租赁的车辆类型、起止时间等信息，系统将记录并等待工作人员处理。</p><blockquote><p><strong>功能需求：</strong></p><ul><li>预定信息可由用户随时查看和取消（在审核前）。</li><li>用户登录后可进入“车辆预定”界面；</li><li>填写预定表单内容：租车人信息、租赁时间段、所需车型、用途说明等；</li><li>系统自动检索对应时间段内可租车辆；</li><li>提交成功后，系统自动生成预定记录，状态为“待处理”；</li></ul></blockquote><p>（2）工作人员处理预定请求：</p><p>工作人员负责审核用户预定请求，确认车辆状态，并将状态变更为“已预定”或“拒绝”。</p><p><strong>功能需求：</strong></p><ul><li>审核通过的预定会锁定对应车辆的时间段状态。</li><li>工作人员登录后可查看所有“待处理”的预定申请；</li><li>支持按日期、用户、车辆类型等条件筛选；</li><li>可进行“通过”或“拒绝”操作，并添加处理备注；</li><li>处理完成后，系统将通知用户审核结果；</li></ul><p>（3）技术人员填写服务记录：</p><p>技术人员在车辆使用前/后进行检查，填写车辆维护与检测记录，保障车辆安全与状态信息准确。</p><p><strong>功能需求：</strong></p><ul><li>登录系统后，可查询并选择需要维护记录的车辆；</li><li>填写内容包括：检查日期、检查人、车辆状况、建议维修、是否可租等；</li><li>提交后，系统更新车辆状态（可租/需维护）；</li><li>服务记录保存至车辆服务历史中。</li></ul><p>（4）工作人员处理还车请求：</p><p>租赁期结束，用户归还车辆，工作人员需核对车辆状况，并更新车辆使用信息及租赁记录。（根据租赁时间和车辆使用状态收取租赁费，如果车辆有损坏收取一定的罚金）</p><p><strong>功能需求：</strong></p><ul><li>归还信息同步到租赁历史记录中。</li><li>系统提供“还车处理”界面；</li><li>工作人员输入车辆编号或租赁单号查询；</li><li>核对车辆归还时间、油量、车况、违章等情况；</li><li>计算最终租赁费用（按日租金×天数+其他费用）；</li><li>如若车辆无误系统自动将租赁记录归档，车辆状态更新为“空闲”；</li><li>如若车辆有损坏，收取一定的罚金，将车辆送往维修厂，车辆状态更新为“维护中”</li></ul><h3 id="4-数据库模块"><strong>4.数据库模块</strong></h3><p>数据库模块是整个汽车租赁系统的数据核心，负责系统中各类信息的存储、管理和调用。通过科学的数据结构设计与数据表管理，确保系统高效、稳定、安全运行，为业务模块提供支撑。</p><h4 id="（1）客户信息管理：">（1）客户信息管理：</h4><p>用于存储和管理客户的基本资料，是租赁流程中用户识别与信用追踪的重要依据。</p><p><strong>主要字段包括：</strong></p><ul><li>客户编号（唯一标识）</li><li>姓名</li><li>性别</li><li>身份证号/驾照号</li><li>联系方式</li><li>注册日期</li><li>租赁历史记录</li><li>备注（如违章记录、黑名单等）</li></ul><p><strong>功能需求：</strong></p><ul><li>支持添加、查询、修改客户信息；</li><li>客户信息在注册或首次租赁时录入；</li><li>系统可根据客户编号或证件号进行唯一性校验；</li><li>敏感信息应加密存储，保障数据安全。</li></ul><h4 id="（2）车辆信息管理：">（2）车辆信息管理：</h4><p>用于维护系统中所有车辆的详细资料，是支撑预定、还车、查询、服务等模块的关键数据来源。</p><p><strong>主要字段包括：</strong></p><ul><li>车辆编号</li><li>品牌型号</li><li>车牌号码</li><li>类型</li><li>当前状态（空闲/租赁中/维护中）</li><li>日租金</li></ul><p><strong>功能需求：</strong></p><ul><li>所有车辆在录入系统时自动生成记录；</li><li>状态字段根据业务流程动态更新；</li><li>支持按车型、状态、编号等条件查询；</li><li>可对车辆信息进行更新（如租金调整、状态更改）。</li></ul><h4 id="（3）租赁信息管理：">（3）租赁信息管理：</h4><p>用于记录每一次租赁交易的完整数据，包括客户、车辆、时间段、费用等，是统计、报表、追责等功能的依据。</p><p><strong>主要字段包括：</strong></p><ul><li>租赁编号（唯一标识）</li><li>客户编号</li><li>车辆编号</li><li>起租时间</li><li>归还时间</li><li>实际归还时间</li><li>总费用</li><li>租赁状态（已完成/未还车/逾期等）</li><li>违章或损坏记录（如有）</li></ul><p><strong>功能需求：</strong></p><ul><li>每次成功预定后生成租赁记录；</li><li>记录车辆的实际归还情况与费用；</li><li>可按客户、车辆、时间段等查询历史租赁记录；</li><li>重要字段不允许擅自修改，保障数据一致性。</li></ul><h4 id="（4）员工信息管理：">（4）员工信息管理：</h4><p>用于维护系统中所有工作人员的数据，分为不同岗位权限，为后台管理操作和分工协作提供依据。</p><p><strong>主要字段包括：</strong></p><ul><li>员工编号</li><li>姓名</li><li>联系电话</li><li>岗位（管理员/客服/技术人员等）</li><li>登录账号</li><li>密码（加密存储）</li><li>入职时间</li></ul><p><strong>功能需求：</strong></p><ul><li>管理员具备添加、修改员工信息权限；</li><li>系统登录需根据员工账号进行权限验证；</li><li>支持岗位权限管理，不同岗位访问系统不同模块；</li><li>可按员工编号、姓名等条件检索。</li></ul><h3 id="5-信息查询模块"><strong>5.信息查询模块</strong></h3><p>信息查询模块为用户与工作人员提供高效、便捷的数据检索服务，支持对客户、员工、车辆及租赁记录等信息的多维度查询，确保系统数据的可访问性和透明度。本模块是系统操作过程中的重要辅助功能。</p><h4 id="（1）查询客户信息：">（1）查询客户信息：</h4><p>工作人员或管理员可根据客户信息进行快速定位与核查。</p><p><strong>功能需求：</strong></p><ul><li>支持按客户编号、姓名、身份证号/驾照号等条件模糊或精确查询；</li><li>展示客户基本信息、联系方式、注册时间、累计租赁次数等；</li><li>可查看该客户所有历史租赁记录；</li><li>提供黑名单或违章记录的标注提示。</li></ul><h4 id="（2）查询员工信息：">（2）查询员工信息：</h4><p>管理员用于管理员工的身份、岗位、权限等信息。</p><p><strong>功能需求：</strong></p><ul><li>可根据员工编号、姓名、岗位进行查询；</li><li>展示员工基本资料、联系方式、所属岗位及入职日期；</li><li>提供岗位权限信息，判断员工是否具备某项操作权限；</li><li>可导出员工信息表作为管理资料。</li></ul><h4 id="（3）查询车辆信息：">（3）查询车辆信息：</h4><p>便于用户选择合适车辆及工作人员掌握车辆运营状态。</p><p><strong>功能需求：</strong></p><ul><li>支持按车辆编号、品牌型号、车牌号、车辆类型、当前状态等查询条件；</li><li>展示车辆的基本信息、当前状态、是否可租、日租金等；</li><li>提供车辆历史服务记录及维修记录查看接口；</li><li>支持状态筛选（仅查看“空闲”车辆、仅查看“维修中”车辆等）；</li><li>可将车辆查询结果导出为表格或打印。</li></ul><h4 id="（4）查询客户租车记录：">（4）查询客户租车记录：</h4><p>用于客户服务、信用评估、异常交易追踪等目的。</p><p><strong>功能需求：</strong></p><ul><li>可按客户编号、姓名进行查询；</li><li>展示所有历史租车记录，包括租赁时间段、车辆信息、费用、归还情况；</li><li>支持对租赁状态（已完成/逾期/未还）进行筛选；</li><li>记录中应包含每次租车的服务情况、是否存在违章或损坏；</li><li>可导出租赁记录明细用于对账、备份或追责。</li></ul><h2 id="2-用例图设计">2.用例图设计</h2><h3 id="1-1-参与者（Actors）">1.1 参与者（Actors）</h3><p>系统中主要的参与者有：</p><ul><li><strong>客户（Customer）</strong>：使用系统提交预定、查询租车记录等。</li><li><strong>工作人员（Staff）</strong>：负责审核预定、处理还车等。</li><li><strong>技术人员（Technician）</strong>：负责填写服务记录，更新车辆状态。</li><li><strong>管理员（Admin）</strong>：负责系统数据维护，包括添加/修改员工和车辆信息。</li></ul><h3 id="1-2-系统主要用例（Use-Cases）">1.2 系统主要用例（Use Cases）</h3><p>将前面分析过的功能模块转化为用例：</p><h4 id="（1）基本数据维护">（1）基本数据维护</h4><ul><li>添加车辆信息</li><li>修改车辆信息</li><li>添加员工信息</li><li>修改员工信息</li></ul><h4 id="（2）基本业务操作">（2）基本业务操作</h4><ul><li>填写租车预定申请</li><li>审核预定请求</li><li>填写车辆服务记录</li><li>处理还车请求</li></ul><h4 id="（3）信息查询">（3）信息查询</h4><ul><li>查询客户信息</li><li>查询员工信息</li><li>查询车辆信息</li><li>查询客户租车记录</li></ul><h3 id="1-3-参与者与用例之间的关系">1.3 参与者与用例之间的关系</h3><table><thead><tr><th>参与者</th><th>可执行的用例</th></tr></thead><tbody><tr><td>客户</td><td>填写租车预定申请、查询客户租车记录</td></tr><tr><td>普通工作人员（客服）</td><td>审核预定请求、处理还车请求、查询客户/车辆信息</td></tr><tr><td>技术人员</td><td>填写车辆服务记录</td></tr><tr><td>管理员</td><td>添加/修改车辆信息、添加/修改员工信息、查询员工信息</td></tr></tbody></table><h3 id="1-4可视化建议（在Rational-Rose中建图）：">1.4可视化建议（在Rational Rose中建图）：</h3><p>整体用一个系统边框（System）包住所有用例，命名为“汽车租赁系统”</p><p>创建4个Actor，分别命名为：</p><ul><li><code>客户</code></li><li><code>工作人员</code></li><li><code>技术人员</code></li><li><code>管理员</code></li></ul><p>创建12个用例（Use Case）：</p><p>每个功能点用椭圆表示，用线连接Actor与他们能够使用的用例</p><table><thead><tr><th>模块</th><th>用例（功能）名称</th><th>所属角色</th></tr></thead><tbody><tr><td>数据维护模块</td><td>添加车辆信息</td><td>管理员</td></tr><tr><td>数据维护模块</td><td>修改车辆信息</td><td>管理员</td></tr><tr><td>数据维护模块</td><td>添加员工信息</td><td>管理员</td></tr><tr><td>数据维护模块</td><td>修改员工信息</td><td>管理员</td></tr><tr><td>业务模块</td><td>填写租车预定申请</td><td>客户</td></tr><tr><td>业务模块</td><td>审核预定请求</td><td>工作人员</td></tr><tr><td>业务模块</td><td>填写服务记录</td><td>技术人员</td></tr><tr><td>业务模块</td><td>处理还车请求</td><td>工作人员</td></tr><tr><td>查询模块</td><td>查询客户信息</td><td>工作人员/管理员</td></tr><tr><td>查询模块</td><td>查询员工信息</td><td>管理员</td></tr><tr><td>查询模块</td><td>查询车辆信息</td><td>工作人员/管理员</td></tr><tr><td>查询模块</td><td>查询客户租车记录</td><td>客户/工作人员</td></tr></tbody></table><h3 id="总结：">总结：</h3><ul><li><strong>“参与者”是使用系统的人或角色</strong></li><li><strong>“用例”是系统提供的某项功能或服务</strong></li><li>一个参与者可以参与多个用例</li><li>一个用例也可以被多个参与者使用（例如查询车辆信息）</li></ul><h2 id="3-类图设计">3.类图设计</h2><p><strong>类图说明系统的静态结构</strong>：有哪些类（实体），它们有哪些属性（字段）、方法（功能），以及类之间的关系（关联、继承、依赖等）。</p><h3 id="系统中的核心类">系统中的核心类</h3><table><thead><tr><th>类名</th><th>上层继承/从属关系</th><th>关联对象</th><th>主要属性字段</th><th>主要方法（功能）</th></tr></thead><tbody><tr><td><strong>Person（抽象类）</strong></td><td>-</td><td>-</td><td>name、ID、address、phoneNo</td><td>getName()、setName() 等</td></tr><tr><td>├─ <strong>Customer</strong>（客户类）</td><td>Person</td><td>Rental（1对多）</td><td>编号、证件号、联系方式、租赁历史记录</td><td>提交预定申请()、查询租赁记录()</td></tr><tr><td>└── <strong>Employee（抽象类-员工）</strong></td><td>Person</td><td>无</td><td>编号、岗位、电话、账号密码</td><td>登录()、操作功能（由子类具体实现）</td></tr><tr><td>├── <em><strong>*Admin*</strong></em>（<strong>管理员</strong>）</td><td>Employee</td><td>无</td><td>是否为高级管理员</td><td>添加员工()、添加车辆()</td></tr><tr><td>├── <strong>CommonWorker</strong>（一般员工-客服）</td><td>Employee</td><td>无</td><td>处理租赁流程</td><td>处理预定()、处理还车()</td></tr><tr><td>└── <strong>SkillWorker</strong>（技术人员）</td><td>Employee</td><td>ServiceRecord（1对多）</td><td>技能项、资格证书、服务记录</td><td>填写服务记录()</td></tr><tr><td><strong>Vehicle</strong>（车辆类）</td><td>-</td><td>Rental、ServiceRecord</td><td>编号、车牌、品牌、类型、状态、租金、维修记录</td><td>更新状态()、计算租金()</td></tr><tr><td><strong>Rental</strong>（租赁类）</td><td>-</td><td>Customer、Vehicle</td><td>租赁编号、客户编号、车辆编号、起止日期、费用、状态</td><td>创建租赁记录()、计算费用()</td></tr><tr><td><strong>ServiceRecord</strong>（服务记录类）</td><td>-</td><td>Vehicle、SkillWorker</td><td>服务编号、车辆编号、技术员编号、检查时间、状况、建议维修</td><td>提交服务记录()</td></tr></tbody></table><p><strong>思路：分两个类图画，一个客户及公司员工类图，一个汽车租赁系统类图</strong></p><h2 id="4-时序图设计">4.时序图设计</h2><p>展示“对象间在某个业务过程中的交互顺序”。</p><p>时序图（Sequence Diagram）用于展示<strong>对象之间在某一用例中的交互过程</strong>，关注消息发送顺序。</p><p>基本元素包括：</p><ul><li><strong>参与对象（Actor 或类的实例）</strong>：上方水平排列</li><li><strong>生命线（Lifeline）</strong>：垂直虚线，表示对象的存活期</li><li><strong>消息（Message）</strong>：对象之间发送的请求，用箭头标示，按时间从上到下</li></ul><h3 id="（1）管理员查看工作记录时序图">（1）管理员查看工作记录时序图</h3><p>该图描述了管理员在系统中查看普通工作人员的工作记录及其任务完成率的流程。该操作用于管理监督和绩效评估。</p><p><strong>参与对象</strong>：</p><ul><li><code>管理员</code>（Admin）</li><li><code>普通工作人员</code>（CommonWorker）</li><li><code>服务记录</code>（ServiceRecord）</li></ul><p><strong>交互顺序</strong>：</p><ol><li>管理员可根据任务情况进行评估与记录。</li><li><code>Admin</code> 登录系统并进入“员工管理”功能界面；</li><li>系统展示可查询员工列表；</li><li><code>Admin</code> 选定某位 <code>CommonWorker</code>，调用其方法 <code>查看工作记录()</code>；</li><li><code>CommonWorker</code> 返回其历史 <code>ServiceRecord</code>；</li><li><code>Admin</code> 要求评估任务完成情况，调用 <code>calculate()</code> 方法计算 <code>commissionRate</code>；</li><li><code>CommonWorker</code> 返回任务完成率给 <code>Admin</code>；</li></ol><h3 id="（2）客户预订车辆时序图"><strong>（2）客户预订车辆时序图</strong></h3><p>该图描述了客户通过系统发起租车申请并由工作人员处理的全过程。</p><p><strong>参与对象</strong>：</p><ul><li><code>客户</code>（Customer）</li><li><code>普通工作人员</code>（CommonWorker）</li><li><code>车辆</code>（Vehicle）</li><li><code>租赁记录</code>（Rental）</li></ul><p><strong>交互顺序</strong>：</p><blockquote><ol><li><code>Customer</code> 填写并提交租赁申请（调用 <code>提交预定申请()</code> 方法）；</li><li><code>CommonWorker</code> 接收申请并调用 <code>处理预定()</code> ；</li><li><code>CommonWorker</code> 通过 <code>Vehicle</code> 查询所需车型是否可租（调用 <code>更新状态()</code>、查询 <code>当前状态</code> 属性）；</li><li>若车辆空闲，则创建一个新的 <code>Rental</code> 实例；</li><li><code>Rental</code> 记录客户、车辆、起止时间等信息，并由 <code>CommonWorker</code> 完成预定处理；</li><li>返回预定结果给 <code>Customer</code>。</li></ol></blockquote><h3 id="（3）客户取车时序图"><strong>（3）客户取车时序图</strong></h3><p>该图展示了客户在预定成功后前往门店取车的业务流程。涉及对租赁状态确认、付款、车辆状态更新等关键操作。</p><p><strong>参与对象</strong>：</p><ul><li><code>客户</code>（Customer）</li><li><code>普通工作人员</code>（CommonWorker）</li><li><code>车辆</code>（Vehicle）</li><li><code>租赁记录</code>（Rental）</li><li><code>服务记录</code>（ServiceRecord`）（填写工作记录）</li></ul><p><strong>交互顺序</strong>：</p><ol><li><code>Customer</code> 按约定时间到店取车；</li><li><code>CommonWorker</code> 校验客户的身份和租赁状态；</li><li>若验证成功，提示 <code>Customer</code> 进行付款；</li><li>付款完成后，<code>CommonWorker</code> 填写 <code>ServiceRecord</code>（调用 <code>填写服务记录()</code> 方法，记录取车信息）；</li><li><code>CommonWorker</code> 调用 <code>Vehicle</code> 类方法 <code>更新状态()</code>，将车辆状态更新为“租赁中”；</li><li><code>Rental</code> 对象状态设置为“进行中”，系统完成租赁激活；</li><li>系统通知客户取车完成。</li></ol><h3 id="（4）客户还车时序图"><strong>（4）客户还车时序图</strong></h3><p>该图展示了客户完成用车后归还车辆的完整流程，包括车辆检查、费用结算、服务记录填写、状态更新等操作。</p><p><strong>参与对象</strong>：</p><ul><li><code>客户</code>（Customer）</li><li><code>普通工作人员</code>（CommonWorker）</li><li><code>技术人员</code>（SkillWorker）</li><li><code>车辆</code>（Vehicle）</li><li><code>租赁记录</code>（Rental）</li><li><code>服务记录</code>（ServiceRecord`）</li></ul><p><strong>交互顺序</strong>：</p><ol><li>Customer 按约定时间归还车辆；</li><li>SkillWorker 对 Vehicle 进行检查，确认车况并调用 填写服务记录()；</li><li>若车辆存在损坏，记录在 ServiceRecord 中，并提交维修建议；</li><li>CommonWorker 根据 Rental 中的起止时间与车辆状态，计算费用（调用 计算费用() 方法）；</li><li>若有损坏或违章，额外费用一并计算；</li><li>Vehicle 状态通过 更新状态() 方法设为“空闲”或“维护中”；</li><li>Rental 状态设为“已完成”，交易结束；</li></ol><h2 id="5-协作图设计">5.协作图设计</h2><p>协作图（Collaboration Diagram）用于描述在某个用例场景中，参与对象之间为了完成任务所进行的交互行为。它重点突出对象之间的<strong>结构关系</strong>与<strong>消息传递顺序</strong>。</p><p>本系统协作图设计覆盖三个典型场景：</p><h3 id="（1）客户预订车辆协作图">（1）客户预订车辆协作图</h3><p>该图描述客户发起租车请求并由系统处理的过程，突出“客户—工作人员—车辆—租赁记录”之间的协作关系。</p><p><strong>参与对象</strong>：</p><ul><li><code>客户</code>（Customer）</li><li><code>普通工作人员</code>（CommonWorker）</li><li><code>车辆</code>（Vehicle）</li><li><code>租赁记录</code>（Rental）</li></ul><p><strong>协作过程</strong>：</p><ol><li><code>Customer</code> 发起租车请求；</li><li><code>CommonWorker</code> 接收并检查请求；</li><li>向 <code>Vehicle</code> 查询当前状态（是否可租）；</li><li>如果可租，生成 <code>Rental</code> 记录并存储租期、费用等信息；</li><li>返回处理结果给 <code>Customer</code>。</li></ol><h3 id="（2）客户取车协作图">（2）客户取车协作图</h3><p>客户在门店取车，由工作人员完成验证、记录与状态更新。</p><p><strong>参与对象</strong>：</p><ul><li><code>客户</code>（Customer）</li><li><code>普通工作人员</code>（CommonWorker）</li><li><code>车辆</code>（Vehicle）</li><li><code>服务记录</code>（ServiceRecord）</li><li><code>租赁记录</code>（Rental）</li></ul><p><strong>协作过程</strong>：</p><ol><li><code>Customer</code> 到达前台，出示身份信息；</li><li><code>CommonWorker</code> 校验信息与租赁状态；</li><li>要求付款并调用 <code>ServiceRecord</code> 填写记录；</li><li>修改 <code>Vehicle</code> 的状态为“租赁中”；</li><li>将 <code>Rental</code> 状态设为“进行中”；</li><li>通知 <code>Customer</code> 成功取车。</li></ol><h3 id="（3）客户还车协作图">（3）客户还车协作图</h3><p>客户完成使用后归还车辆，系统进行检查、结算与状态同步。</p><p><strong>参与对象</strong>：</p><ul><li><code>客户</code>（Customer）</li><li><code>普通工作人员</code>（CommonWorker）</li><li><code>技术人员</code>（SkillWorker）</li><li><code>车辆</code>（Vehicle）</li><li><code>服务记录</code>（ServiceRecord）</li><li><code>租赁记录</code>（Rental）</li></ul><p><strong>协作过程</strong>：</p><ol><li><code>Customer</code> 提交还车；</li><li><code>SkillWorker</code> 检查车辆，填写 <code>ServiceRecord</code>；</li><li><code>CommonWorker</code> 根据 <code>Rental</code> 计算费用；</li><li>如有异常（如车辆损坏），加入额外罚金；</li><li>调用 <code>Vehicle</code> 更新状态为“空闲”或“维护中”；</li><li>更新 <code>Rental</code> 为“已完成”，关闭流程；</li><li>通知 <code>Customer</code> 交易结束。</li></ol><h2 id="6-活动图设计">6. 活动图设计</h2><p>活动图（Activity Diagram）用于表示系统中某个用例或业务流程的<strong>控制流程</strong>与<strong>状态流转</strong>，强调操作的执行顺序与并发结构。以下选取三个典型业务流程进行建模。</p><h3 id="（1）客户预订车辆活动图">（1）客户预订车辆活动图</h3><p>该图描述了客户租车申请从填写表单到系统生成预定记录的全过程。</p><p><strong>流程说明</strong>：</p><ul><li>初始节点：客户登录系统；</li><li>填写租车申请表（车型、时间等）；</li><li>系统校验字段完整性；</li><li>系统检查该时间段内是否有可租车辆；<ul><li>若无车辆 → 流程结束，提示“预定失败”；</li><li>若有车辆 → 进入下一步；</li></ul></li><li>系统生成预定记录；</li><li>将预定状态设为“待审核”；</li><li>返回“预定提交成功”提示。</li></ul><h3 id="（2）客户取车活动图">（2）客户取车活动图</h3><p>展示客户前往门店领取车辆的完整操作流程。</p><p><strong>流程说明</strong>：</p><ul><li>初始节点：客户到达门店；</li><li>出示身份信息；</li><li>工作人员验证预订状态；<ul><li>若状态异常 → 结束流程，提示“验证失败”；</li><li>若验证成功 → 进入下一步；</li></ul></li><li>系统提示付款；</li><li>客户付款；</li><li>工作人员填写服务记录；</li><li>更新车辆状态为“租赁中”；</li><li>结束流程，客户完成取车。</li></ul><h3 id="（3）客户还车活动图">（3）客户还车活动图</h3><p>描述客户用车结束后归还车辆的业务流程。</p><p><strong>流程说明</strong>：</p><ul><li>初始节点：客户提交还车；</li><li>技术人员进行车辆检查；</li><li>系统记录服务检查结果；</li><li>工作人员根据租期与车况计算费用；</li><li>客户付款（含额外罚金）；</li><li>系统更新车辆状态（空闲/维护中）；</li><li>租赁记录设为“已完成”；</li><li>流程终止。</li></ul><h2 id="7-状态图设计">7. 状态图设计</h2><p>状态图（State Diagram）用于描述系统中某一对象在生命周期中所经历的<strong>状态变迁</strong>，以及引起这些状态变化的事件或条件。它对于理解对象行为及其触发逻辑尤为重要。</p><p>本系统重点绘制以下两个状态图：</p><h3 id="（1）车辆（Vehicle）状态图">（1）车辆（Vehicle）状态图</h3><p>车辆在租赁生命周期中会经历多个状态变化，状态图可清晰展示其状态切换逻辑。</p><p><strong>状态节点</strong>：</p><ul><li>空闲（Idle）</li><li>已预定（Reserved）</li><li>租赁中（Rented）</li><li>检修中（Under Maintenance）</li></ul><p><strong>触发事件</strong>：</p><ul><li>客户提交预定申请 → 状态由“空闲”变为“已预定”</li><li>客户取车 → 状态变为“租赁中”</li><li>客户还车后车辆正常 → 状态变为“空闲”</li><li>客户还车后车辆损坏 → 状态变为“检修中”</li><li>检修完毕 → 状态恢复为“空闲”</li></ul><h3 id="（2）租赁记录（Rental）状态图">（2）租赁记录（Rental）状态图</h3><p><code>Rental</code> 对象代表一次租赁交易，其状态流转反映交易的执行进度与完成情况。</p><p><strong>状态节点</strong>：</p><ul><li>待审核（Pending）</li><li>已批准（Approved）</li><li>进行中（Ongoing）</li><li>已完成（Completed）</li><li>被拒绝（Rejected）</li></ul><p><strong>触发事件</strong>：</p><ul><li>用户提交申请 → 状态设为“待审核”</li><li>工作人员审核通过 → 状态变为“已批准”</li><li>客户取车后 → 状态设为“进行中”</li><li>客户还车并结算完成 → 状态设为“已完成”</li><li>审核不通过 → 状态变为“被拒绝”</li></ul><p>以下附上实验报告</p><p><a href="https://www.legendkiller.xyz/wp-content/uploads/2025/05/%E8%AE%A1%E6%9C%AC2204-202214024112-%E7%8E%8B%E7%A3%8A-1-3.doc">计本2204 202214024112 王磊</a><a href="https://www.legendkiller.xyz/wp-content/uploads/2025/05/%E8%AE%A1%E6%9C%AC2204-202214024112-%E7%8E%8B%E7%A3%8A-1-3.doc">下载</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> UML建模 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redis基础篇</title>
      <link href="/posts/5.html"/>
      <url>/posts/5.html</url>
      
        <content type="html"><![CDATA[<h2 id="1-初识Redis">1.初识Redis</h2><p>Redis是一种键值型的NoSql数据库，这里有两个关键字：</p><ul><li>键值型</li><li>NoSql</li></ul><p>其中<strong>键值型</strong>，是指Redis中存储的数据都是以key、value对的形式存储，而value的形式多种多样，可以是字符串、数值、甚至json：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-1024x416.png" alt="img"></p><h3 id=""></h3><h3 id="1-1-认识NoSQL">1.1.认识NoSQL</h3><p><strong>NoSql</strong>可以翻译做Not Only Sql（不仅仅是SQL），或者是No Sql（非Sql的）数据库。是相对于传统关系型数据库而言，有很大差异的一种特殊的数据库，因此也称之为<strong>非关系型数据库</strong>。</p><ul><li>Redis</li><li>Mongo db</li><li>MemCached</li></ul><h4 id="1-1-1-结构化与非结构化">1.1.1.结构化与非结构化</h4><p>传统关系型数据库是结构化数据，每一张表都有严格的约束信息：字段名、字段数据类型、字段约束等等信息，插入的数据必须遵守这些约束：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-2.png" alt="img"></p><p>而NoSql则对数据库格式没有严格约束，往往形式松散，自由。</p><p>可以是键值型：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-3.png" alt="img"></p><p>也可以是文档型：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-4.png" alt="img"></p><p>甚至可以是图格式：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-5.png" alt="img"></p><h4 id="1-1-2-关联和非关联">1.1.2.关联和非关联</h4><p>传统数据库的表与表之间往往存在关联，例如外键：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-6-1024x520.png" alt="img"></p><p>而非关系型数据库不存在关联关系，要维护关系要么靠代码中的业务逻辑，要么靠数据之间的耦合：</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="params">id:</span> <span class="number">1</span>,</span><br><span class="line">  <span class="params">name:</span> <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  <span class="params">orders:</span> [</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="params">id:</span> <span class="number">1</span>,</span><br><span class="line">       <span class="params">item:</span> &#123;</span><br><span class="line">     <span class="params">id:</span> <span class="number">10</span>, <span class="params">title:</span> <span class="string">&quot;荣耀6&quot;</span>, <span class="params">price:</span> <span class="number">4999</span></span><br><span class="line">       &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="params">id:</span> <span class="number">2</span>,</span><br><span class="line">       <span class="params">item:</span> &#123;</span><br><span class="line">     <span class="params">id:</span> <span class="number">20</span>, <span class="params">title:</span> <span class="string">&quot;小米11&quot;</span>, <span class="params">price:</span> <span class="number">3999</span></span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此处要维护“张三”的订单与商品“荣耀”和“小米11”的关系，不得不冗余的将这两个商品保存在张三的订单文档中，不够优雅。还是建议用业务来维护关联关系。</p><h4 id="1-1-3-查询方式">1.1.3.查询方式</h4><p>传统关系型数据库会基于Sql语句做查询，语法有统一标准；</p><p>而不同的非关系数据库查询语法差异极大，五花八门各种各样。</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-7-1024x391.png" alt="img"></p><h4 id="1-1-4-事务">1.1.4.事务</h4><p>传统关系型数据库能满足事务ACID的原则。</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-8.png" alt="img"></p><p>而非关系型数据库往往不支持事务，或者不能严格保证ACID的特性，只能实现基本的一致性。</p><h4 id="1-1-5-总结">1.1.5.总结</h4><p>除了上述四点以外，在存储方式、扩展性、查询性能上关系型与非关系型也都有着显著差异，总结如下：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-9-1024x483.png" alt="img"></p><ul><li>存储方式<ul><li>关系型数据库基于磁盘进行存储，会有大量的磁盘IO，对性能有一定影响</li><li>非关系型数据库，他们的操作更多的是依赖于内存来操作，内存的读写速度会非常快，性能自然会好一些</li></ul></li><li>扩展性<ul><li>关系型数据库集群模式一般是主从，主从数据一致，起到数据备份的作用，称为垂直扩展。</li><li>非关系型数据库可以将数据拆分，存储在不同机器上，可以保存海量数据，解决内存大小有限的问题。称为水平扩展。</li><li>关系型数据库因为表之间存在关联关系，如果做水平扩展会给数据查询带来很多麻烦</li></ul></li></ul><h3 id="1-2-认识Redis">1.2.认识Redis</h3><p><strong>特征</strong>：</p><ul><li>键值（key-value）型，value支持多种不同数据结构，功能丰富</li><li>单线程，每个命令具备原子性</li><li>低延迟，速度快（基于内存、IO多路复用、良好的编码）。</li><li>支持数据持久化</li><li>支持主从集群、分片集群</li><li>支持多语言客户端</li></ul><h3 id="1-3-Redis的启动">1.3 Redis的启动</h3><p>redis的启动方式有很多种，例如：</p><ul><li>默认启动</li><li>指定配置启动</li><li>开机自启</li></ul><h4 id="1-3-1默认启动">1.3.1默认启动</h4><p>安装完成后，在任意目录输入redis-server命令即可启动Redis：</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-<span class="keyword">server</span></span><br></pre></td></tr></table></figure><h4 id="1-3-2-指定配置启动">1.3.2.指定配置启动</h4><p>如果要让Redis以<code>后台</code>方式启动，则必须修改Redis配置文件</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 进入redis安装目录 </span></span><br><span class="line"><span class="meta"># 启动</span></span><br><span class="line">redis-<span class="keyword">server</span>.exe redis.windows.conf</span><br><span class="line">Redis服务默认端口号为 <span class="number">6379</span> ，通过快捷键Ctrl + C 即可停止Redis服务</span><br><span class="line"></span><br><span class="line">当Redis服务启动成功后，可通过客户端进行连接。</span><br></pre></td></tr></table></figure><p>然后修改redis.conf文件中的一些配置：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 允许访问的地址，默认是127.0.0.1，会导致只能在本地访问。修改为0.0.0.0则可以在任意IP访问，生产环境不要设置为0.0.0.0</span></span><br><span class="line"><span class="attribute">bind</span> <span class="number">0.0.0.0</span></span><br><span class="line"><span class="comment"># 守护进程，修改为yes后即可后台运行 （windows不支持）</span></span><br><span class="line">daemonize <span class="literal">yes</span> </span><br><span class="line"><span class="comment"># 密码，设置后访问Redis必须输入密码</span></span><br><span class="line">requirepass <span class="number">123456</span></span><br></pre></td></tr></table></figure><p>Redis的其它常见配置：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 监听的端口</span></span><br><span class="line"><span class="attribute">port</span> <span class="number">6379</span></span><br><span class="line"><span class="comment"># 工作目录，默认是当前目录，也就是运行redis-server时的命令，日志、持久化等文件会保存在这个目录</span></span><br><span class="line"><span class="attribute">dir</span> .</span><br><span class="line"><span class="comment"># 数据库数量，设置为1，代表只使用1个库，默认有16个库，编号0~15</span></span><br><span class="line"><span class="attribute">databases</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># 设置redis能够使用的最大内存</span></span><br><span class="line"><span class="attribute">maxmemory</span> <span class="number">512</span>mb</span><br><span class="line"><span class="comment"># 日志文件，默认为空，不记录日志，可以指定日志文件名</span></span><br><span class="line"><span class="attribute">logfile</span> <span class="string">&quot;redis.log&quot;</span></span><br></pre></td></tr></table></figure><p>停止服务：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用redis-cli来执行 shutdown 命令，即可停止 Redis 服务，</span></span><br><span class="line"><span class="comment"># 因为之前配置了密码，因此需要通过 -u 来指定密码</span></span><br><span class="line"><span class="attribute">redis</span>-cli -u <span class="number">123456</span> shutdown</span><br></pre></td></tr></table></figure><h4 id="1-3-3-客户端连接命令">1.3.3 客户端连接命令</h4><p><strong>redis-cli.exe</strong></p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-10-1024x261.png" alt="img"></p><p>通过redis-cli.exe命令默认连接的是本地的redis服务，并且使用默认6379端口。也可以通过指定如下参数连接：</p><ul><li>-h ip地址</li><li>-p 端口号</li><li>-a 密码（如果需要）</li><li></li></ul><h4 id="1-3-4Redis客户端图形工具">1.3.4Redis客户端图形工具</h4><p>默认提供的客户端连接工具界面不太友好，同时操作也较为麻烦，需引入一个Redis客户端图形工具。</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-11-1024x771.png" alt="img"></p><h2 id="2-Redis数据类型">2. Redis数据类型</h2><h3 id="2-1-五种常用数据类型介绍">2.1 五种常用数据类型介绍</h3><p>Redis存储的是key-value结构的数据，其中key是字符串类型，value有5种常用的数据类型：</p><ul><li>字符串 string</li><li>哈希 hash</li><li>列表 list</li><li>集合 set</li><li>有序集合 sorted set / zset</li></ul><h3 id="2-2-各种数据类型特点">2.2 各种数据类型特点</h3><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-12.png" alt="img"></p><p><strong>解释说明：</strong></p><ul><li>字符串(string)：普通字符串，Redis中最简单的数据类型</li><li>哈希(hash)：也叫散列，类似于Java中的HashMap结构</li><li>列表(list)：按照插入顺序排序，可以有重复元素，类似于Java中的LinkedList</li><li>集合(set)：无序集合，没有重复元素，类似于Java中的HashSet</li><li>有序集合(sorted set/zset)：集合中每个元素关联一个分数(score)，根据分数升序排序，没有重复元素</li></ul><p>Redis是典型的key-value数据库，key一般是字符串，而value包含很多不同的数据类型：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-13-1024x516.png" alt="img"></p><h2 id="3-Redis常用命令">3. Redis常用命令</h2><h3 id="3-1-String字符串操作命令">3.1 String字符串操作命令</h3><p>Redis 中字符串类型常用命令：</p><ul><li>SET：添加或者修改已经存在的一个String类型的键值对</li><li>GET：根据key获取String类型的value</li><li>MSET：批量添加多个String类型的键值对</li><li>MGET：根据多个key获取多个String类型的value</li><li>INCR：让一个整型的key自增1</li><li>INCRBY:让一个整型的key自增并指定步长，例如：incrby num 2 让num值自增2</li><li>INCRBYFLOAT：让一个浮点类型的数字自增并指定步长</li><li>SETNX：添加一个String类型的键值对，前提是这个key不存在，否则不执行</li><li>SETEX：添加一个String类型的键值对，并且指定有效期</li></ul><p>更多命令可以参考Redis中文网：<a href="https://www.redis.net.cn/">https://www.redis.net.cn</a></p><h3 id="3-2-Hash哈希操作命令">3.2 Hash哈希操作命令</h3><p>Redis hash 是一个string类型的 field 和 value 的映射表，hash特别适合用于存储对象，常用命令：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-14.png" alt="img"></p><ul><li>HSET key field value：添加或者修改hash类型key的field的值</li><li>HGET key field：获取一个hash类型key的field的值</li><li>HMSET：批量添加多个hash类型key的field的值</li><li>HMGET：批量获取多个hash类型key的field的值</li><li>HGETALL：获取一个hash类型的key中的所有的field和value</li><li>HKEYS：获取一个hash类型的key中的所有的field</li><li>HINCRBY:让一个hash类型key的字段值自增并指定步长</li><li>HSETNX：添加一个hash类型的key的field值，前提是这个field不存在，否则不执行</li></ul><h3 id="3-3-List列表操作命令">3.3 List列表操作命令</h3><p>Redis中的List类型与Java中的LinkedList类似，可以看做是一个双向链表结构。既可以支持正向检索和也可以支持反向检索。</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-15.png" alt="img"></p><p>特征也与LinkedList类似：</p><ul><li>有序</li><li>元素可以重复</li><li>插入和删除快</li><li>查询速度一般</li></ul><p>常用来存储一个有序数据，例如：朋友圈点赞列表，评论列表等。</p><ul><li>LPUSH key element … ：向列表左侧插入一个或多个元素</li><li>LPOP key：移除并返回列表左侧的第一个元素，没有则返回nil</li><li>RPUSH key element … ：向列表右侧插入一个或多个元素</li><li>RPOP key：移除并返回列表右侧的第一个元素</li><li>LRANGE key star end：返回一段角标范围内的所有元素</li><li>BLPOP和BRPOP：与LPOP和RPOP类似，只不过在没有元素时等待指定时间，而不是直接返回nil</li></ul><h3 id="3-4-Set集合操作命令">3.4 Set集合操作命令</h3><p>Redis的Set结构与Java中的HashSet类似，可以看做是一个value为null的HashMap。因为也是一个hash表，因此具备与HashSet类似的特征：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-16.png" alt="img"></p><ul><li>支持交集、并集、差集等功能</li><li>无序</li><li>元素不可重复</li><li>查找快</li></ul><p>Set的常见命令有：</p><ul><li>SADD key member … ：向set中添加一个或多个元素</li><li>SREM key member … : 移除set中的指定元素</li><li>SCARD key： 返回set中元素的个数</li><li>SISMEMBER key member：判断一个元素是否存在于set中</li><li>SMEMBERS：获取set中的所有元素</li><li>SINTER key1 key2 … ：求key1与key2的交集</li></ul><h3 id="3-5-SortedSet有序集合操作命令">3.5 SortedSet有序集合操作命令</h3><p>Redis的SortedSet是一个可排序的set集合，与Java中的TreeSet有些类似，但底层数据结构却差别很大。SortedSet中的每一个元素都带有一个score属性，可以基于score属性对元素排序，底层的实现是一个跳表（SkipList）加 hash表。</p><p>SortedSet具备下列特性：</p><ul><li>可排序</li><li>元素不重复</li><li>查询速度快</li></ul><p>因为SortedSet的可排序特性，经常被用来实现排行榜这样的功能。</p><p>常用命令：</p><ul><li>ZADD key score member：添加一个或多个元素到sorted set ，如果已经存在则更新其score值</li><li>ZREM key member：删除sorted set中的一个指定元素</li><li>ZSCORE key member : 获取sorted set中的指定元素的score值</li><li>ZRANK key member：获取sorted set 中的指定元素的排名</li><li>ZCARD key：获取sorted set中的元素个数</li><li>ZCOUNT key min max：统计score值在给定范围内的所有元素的个数</li><li>ZINCRBY key increment member：让sorted set中的指定元素自增，步长为指定的increment值</li><li>ZRANGE key min max：按照score排序后，获取指定排名范围内的元素</li><li>ZRANGEBYSCORE key min max：按照score排序后，获取指定score范围内的元素</li><li>ZDIFF、ZINTER、ZUNION：求差集、交集、并集</li><li>注意：所有的排名默认都是升序，如果要降序则在命令的Z后面添加REV即可，例如：</li><li><strong>升序</strong>获取sorted set 中的指定元素的排名：ZRANK key member</li><li><strong>降序</strong>获取sorted set 中的指定元素的排名：ZREVRANK key memeber</li></ul><p>注意：所有的排名默认都是升序，如果要降序则在命令的Z后面添加REV即可，例如：</p><ul><li><strong>升序</strong>获取sorted set 中的指定元素的排名：ZRANK key member</li><li><strong>降序</strong>获取sorted set 中的指定元素的排名：ZREVRANK key memeber</li></ul><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-17.png" alt="img"></p><h3 id="3-6-通用命令">3.6 通用命令</h3><p>Redis的通用命令是不分数据类型的，都可以使用的命令：</p><ul><li>KEYS pattern 查找所有符合给定模式( pattern)的 key</li><li>EXISTS key 检查给定 key 是否存在</li><li>TYPE key 返回 key 所储存的值的类型</li><li>DEL key 该命令用于在 key 存在是删除 key</li><li>EXPIRE key 给一个key设置有效期，有效期到期时key会自动删除</li><li>TTL key 查看一个key的剩余有效期(-1永久，-2被移除)</li></ul><h3 id="3-7-Key结构">3.7 Key结构</h3><p>Redis没有类似MySQL中的Table的概念，我们该如何区分不同类型的key呢？</p><p>例如，需要存储用户、商品信息到redis，有一个用户id是1，有一个商品id恰好也是1，此时如果使用id作为key，那就会冲突了，该怎么办？</p><p>我们可以通过给key添加前缀加以区分，不过这个前缀不是随便加的，有一定的规范：</p><p>Redis的key允许有多个单词形成层级结构，多个单词之间用’:'隔开，格式如下：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">项目名:业务名:类型:<span class="built_in">id</span></span><br></pre></td></tr></table></figure><p>这个格式并非固定，也可以根据自己的需求来删除或添加词条。这样以来，我们就可以把不同类型的数据区分开了。从而避免了key的冲突问题。</p><p>例如我们的项目名称叫 heima，有user和product两种不同类型的数据，我们可以这样定义key：</p><ul><li>user相关的key：<strong>heima:user:1</strong></li><li>product相关的key：<strong>heima:product:1</strong></li></ul><p>如果Value是一个Java对象，例如一个User对象，则可以将对象序列化为JSON字符串后存储：</p><table><thead><tr><th><strong>KEY</strong></th><th><strong>VALUE</strong></th></tr></thead><tbody><tr><td>heima:user:1</td><td>{“id”:1, “name”: “Jack”, “age”: 21}</td></tr><tr><td>heima:product:1</td><td>{“id”:1, “name”: “小米11”, “price”: 4999}</td></tr></tbody></table><p>并且，在Redis的桌面客户端中，还会以相同前缀作为层级结构，让数据看起来层次分明，关系清晰。</p><h2 id="4-在Java中操作Redis">4.在Java中操作Redis</h2><h3 id="4-1-Redis的Java客户端">4.1 Redis的Java客户端</h3><p>前面我们讲解了Redis的常用命令，这些命令是我们操作Redis的基础，那么我们在java程序中应该如何操作Redis呢？这就需要使用Redis的Java客户端，就如同我们使用JDBC操作MySQL数据库一样。</p><p>Redis 的 Java 客户端很多，常用的几种：</p><ul><li>Jedis</li><li>Lettuce</li><li>Spring Data Redis</li></ul><p>Spring 对 Redis 客户端进行了整合，提供了 Spring Data Redis，在Spring Boot项目中还提供了对应的Starter，即 spring-boot-starter-data-redis。</p><p>我们重点学习<strong>Spring Data Redis</strong>。</p><h4 id="4-1-1Jedis客户端">4.1.1Jedis客户端</h4><p>Jedis的官网地址： <a href="https://github.com/redis/jedis">https://github.com/redis/jedis</a>   （快速入门）</p><h4 id="4-1-2-SpringDataRedis客户端">4.1.2 SpringDataRedis客户端</h4><p>SpringData是Spring中数据操作的模块，包含对各种数据库的集成，其中对Redis的集成模块就叫做SpringDataRedis，官网地址：<a href="https://spring.io/projects/spring-data-redis">https://spring.io/projects/spring-data-redis</a></p><ul><li>提供了对不同Redis客户端的整合（Lettuce和Jedis）</li><li>提供了RedisTemplate统一API来操作Redis</li><li>支持Redis的发布订阅模型</li><li>支持Redis哨兵和Redis集群</li><li>支持基于Lettuce的响应式编程</li><li>支持基于JDK、JSON、字符串、Spring对象的数据序列化及反序列化</li><li>支持基于Redis的JDKCollection实现</li></ul><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-18-1024x331.png" alt="img"></p><p><strong>环境搭建</strong>：</p><p><strong>1). 导入Spring Data Redis的maven坐标</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2). 配置Redis数据源</strong></p><p>在application-dev.yml中添加</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sky:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">10</span></span><br><span class="line">    <span class="attr">lettuce:</span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">8</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">8</span></span><br><span class="line">        <span class="attr">min-idle:</span> <span class="number">0</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="string">100ms</span></span><br></pre></td></tr></table></figure><p>database:指定使用Redis的哪个数据库，Redis服务启动后默认有16个数据库，编号分别是从0到15。</p><p>可以通过修改Redis配置文件来指定数据库的数量。</p><p>在application.yml中添加读取application-dev.yml中的相关Redis配置</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">spring:</span></span><br><span class="line"><span class="symbol">  profiles:</span></span><br><span class="line"><span class="symbol">    active:</span> dev</span><br><span class="line"><span class="symbol">  redis:</span></span><br><span class="line"><span class="symbol">    host:</span> $<span class="punctuation">&#123;</span>sky.redis.host<span class="punctuation">&#125;</span></span><br><span class="line"><span class="symbol">    port:</span> $<span class="punctuation">&#123;</span>sky.redis.port<span class="punctuation">&#125;</span></span><br><span class="line"><span class="symbol">    password:</span> $<span class="punctuation">&#123;</span>sky.redis.password<span class="punctuation">&#125;</span></span><br><span class="line"><span class="symbol">    database:</span> $<span class="punctuation">&#123;</span>sky.redis.database<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>3). 编写配置类，创建RedisTemplate对象</strong>，自定义RedisTemplate的序列化方式</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> RedisConfig &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; redisTemplate(RedisConnectionFactory connectionFactory)&#123;</span><br><span class="line">        <span class="comment">// 创建RedisTemplate对象</span></span><br><span class="line">        RedisTemplate&lt;String, Object&gt; <span class="keyword">template</span> = <span class="keyword">new</span> RedisTemplate&lt;&gt;();</span><br><span class="line">        <span class="comment">// 设置连接工厂</span></span><br><span class="line">        <span class="keyword">template</span>.setConnectionFactory(connectionFactory);</span><br><span class="line">        <span class="comment">// 创建JSON序列化工具</span></span><br><span class="line">        GenericJackson2JsonRedisSerializer jsonRedisSerializer = </span><br><span class="line">            <span class="keyword">new</span> GenericJackson2JsonRedisSerializer();</span><br><span class="line">        <span class="comment">// 设置Key的序列化</span></span><br><span class="line">        <span class="keyword">template</span>.setKeySerializer(RedisSerializer.<span class="built_in">string</span>());</span><br><span class="line">        <span class="keyword">template</span>.setHashKeySerializer(RedisSerializer.<span class="built_in">string</span>());</span><br><span class="line">        <span class="comment">// 设置Value的序列化</span></span><br><span class="line">        <span class="keyword">template</span>.setValueSerializer(jsonRedisSerializer);</span><br><span class="line">        <span class="keyword">template</span>.setHashValueSerializer(jsonRedisSerializer);</span><br><span class="line">        <span class="comment">// 返回</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">template</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-19-1024x210.png" alt="img"></p><p>缺点：</p><ul><li>可读性差</li><li>内存占用较大</li></ul><p>这里采用了JSON序列化来代替默认的JDK序列化方式。最终结果如图：</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-20-1024x326.png" alt="img"></p><p>*<strong>为了节省内存空间*</strong>，我们可以不使用JSON序列化器来处理value，而是统一使用String序列化器，要求只能存储String类型的key和value。当需要存储Java对象时，手动完成对象的序列化和反序列化。</p><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-21-1024x352.png" alt="img"></p><p>StringRedisTemplate，它的key和value的序列化方式默认就是String方式。</p><p>省去了我们自定义RedisTemplate的序列化方式的步骤，而是直接使用：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"><span class="comment">// JSON序列化工具</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSaveUser</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">    <span class="comment">// 创建对象</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;虎哥&quot;</span>, <span class="number">21</span>);</span><br><span class="line">    <span class="comment">// 手动序列化</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> mapper.writeValueAsString(user);</span><br><span class="line">    <span class="comment">// 写入数据</span></span><br><span class="line">    stringRedisTemplate.opsForValue().set(<span class="string">&quot;user:200&quot;</span>, json);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取数据</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">jsonUser</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(<span class="string">&quot;user:200&quot;</span>);</span><br><span class="line">    <span class="comment">// 手动反序列化</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> mapper.readValue(jsonUser, User.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;user1 = &quot;</span> + user1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>小结：RedisTemplate 和 StringRedisTemplate</strong></p><p><code>**RedisTemplate**</code>（泛型通用）：</p><ul><li>是一个<strong>通用的 Redis 操作模板</strong>，支持任意类型的 key 和 value（通过泛型控制），例如对象、列表、哈希等。</li><li>需要自己配置序列化器（比如 <code>Jackson2JsonRedisSerializer</code>）来处理 key/value 的序列化与反序列化</li></ul><p><code>**StringRedisTemplate**</code>（专门针对字符串）</p><ul><li>是 <code>RedisTemplate&lt;String, String&gt;</code> 的一个<strong>专用子类</strong>。</li><li>内部已经默认设置好了字符串的序列化方式，适合 key 和 value 都是字符串的场景。</li><li>使用更简单直观，常用于缓存简单字符串值，如：</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stringRedisTemplate.opsForValue().<span class="built_in">set</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://www.legendkiller.xyz/wp-content/uploads/2025/05/image-22.png" alt="img"></p><h1 id="Redis基础篇完结"><strong>Redis基础篇完结</strong></h1>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
